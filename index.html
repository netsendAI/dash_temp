<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AB-—Ç–µ—Å—Ç IN-4868: –¢–µ–Ω–µ–≤—ã–µ —Å–∫–∏–¥–∫–∏</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        
        .header {
            text-align: center;
            padding: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            margin-bottom: 20px;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header .subtitle { color: #888; font-size: 1.1em; }
        .header .uuid { color: #666; font-size: 0.9em; font-family: monospace; }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            transition: transform 0.3s;
        }
        .metric-card:hover { transform: translateY(-5px); }
        .metric-card .label { color: #888; font-size: 0.9em; margin-bottom: 10px; }
        .metric-card .values {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
        }
        .metric-card .value-box {
            text-align: center;
        }
        .metric-card .value-box .variant { 
            font-size: 0.8em; 
            color: #888;
            margin-bottom: 5px;
        }
        .metric-card .value-box .value { 
            font-size: 1.8em; 
            font-weight: bold;
        }
        .metric-card .value-box.a .value { color: #3498db; }
        .metric-card .value-box.b .value { color: #9b59b6; }
        .metric-card .lift {
            font-size: 1.5em;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
        }
        .metric-card .lift.negative { background: rgba(231, 76, 60, 0.2); color: #e74c3c; }
        .metric-card .lift.positive { background: rgba(39, 174, 96, 0.2); color: #27ae60; }
        
        .target-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border: 2px solid #e74c3c;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        .target-card h2 { margin-bottom: 15px; }
        .target-card .status { font-size: 2em; color: #e74c3c; }
        .target-card .details { color: #888; margin-top: 10px; }
        
        .filter-section {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .filter-section h3 {
            margin-bottom: 15px;
            color: #fff;
        }
        .filter-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .filter-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .filter-checkbox label {
            cursor: pointer;
            user-select: none;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .daily-charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1200px) {
            .daily-charts-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .chart-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 20px;
        }
        .chart-card h3 { margin-bottom: 15px; color: #fff; }
        .chart { height: 300px; }
        
        .split-bar {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            height: 40px;
            display: flex;
            overflow: hidden;
            margin: 20px 0;
        }
        .split-bar .a { background: #3498db; display: flex; align-items: center; justify-content: center; }
        .split-bar .b { background: #9b59b6; display: flex; align-items: center; justify-content: center; }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .legend-dot.a { background: #3498db; }
        .legend-dot.b { background: #9b59b6; }
        
        .funnel-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .funnel-table th, .funnel-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .funnel-table th { color: #888; }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
<!-- –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ -->
    <div id="login-screen">
        <h2>–î–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥—É</h2>
        <p>–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞.</p>
        <input id="login-input" type="text" placeholder="–õ–æ–≥–∏–Ω">
        <input id="password-input" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
        <button id="login-button">–í–æ–π—Ç–∏</button>
        <div id="login-error" style="display:none;color:#e74c3c;font-size:0.85em;margin-top:10px;">–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å</div>
    </div>

    <div id="dashboard" style="display:none;">

    <div class="container">
        <div class="header">
            <h1>üß™ AB-—Ç–µ—Å—Ç: –¢–µ–Ω–µ–≤—ã–µ —Å–∫–∏–¥–∫–∏</h1>
            <div class="subtitle">IN-4868 | –ü–µ—Ä–∏–æ–¥: 2026-01-20 ‚Äî 2026-01-26</div>
            <div class="subtitle" style="margin-top: 5px; font-size: 0.9em;">–í–∏—Ç—Ä–∏–Ω—ã: desktop, android, ios, mobweb (–±–µ–∑ white-label)</div>
            <div class="uuid">UUID: 944ace4b-4521-4191-b02c-112d688c0460</div>
        </div>
        
        <div class="filter-section">
            <h3>üîç –§–∏–ª—å—Ç—Ä –ø–æ —Ç—É—Ä-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º</h3>
            <div class="filter-checkboxes">
                <div class="filter-checkbox">
                    <input type="checkbox" id="filter-all" checked>
                    <label for="filter-all">–í—Å–µ —Ç—É—Ä-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã</label>
                </div>
                <div class="filter-checkbox"><input type="checkbox" id="filter-0" class="tour-operator-filter" value="AleanTour" checked><label for="filter-0">AleanTour</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-1" class="tour-operator-filter" value="Anex" checked><label for="filter-1">Anex</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-2" class="tour-operator-filter" value="Biblio Globus" checked><label for="filter-2">Biblio Globus</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-3" class="tour-operator-filter" value="China Travel" checked><label for="filter-3">China Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-4" class="tour-operator-filter" value="Coral Travel" checked><label for="filter-4">Coral Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-5" class="tour-operator-filter" value="FUN&SUN" checked><label for="filter-5">FUN&SUN</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-6" class="tour-operator-filter" value="ICS Travel Group" checked><label for="filter-6">ICS Travel Group</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-7" class="tour-operator-filter" value="IZI Tour" checked><label for="filter-7">IZI Tour</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-8" class="tour-operator-filter" value="Intourist" checked><label for="filter-8">Intourist</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-9" class="tour-operator-filter" value="Let‚Äôs Fly" checked><label for="filter-9">Let‚Äôs Fly</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-10" class="tour-operator-filter" value="One Touch Travel" checked><label for="filter-10">One Touch Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-11" class="tour-operator-filter" value="PAKS" checked><label for="filter-11">PAKS</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-12" class="tour-operator-filter" value="Pegas Touristik" checked><label for="filter-12">Pegas Touristik</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-13" class="tour-operator-filter" value="RussianExpress" checked><label for="filter-13">RussianExpress</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-14" class="tour-operator-filter" value="Space Travel" checked><label for="filter-14">Space Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-15" class="tour-operator-filter" value="Sunmar" checked><label for="filter-15">Sunmar</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-16" class="tour-operator-filter" value="Tez Tour" checked><label for="filter-16">Tez Tour</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-17" class="tour-operator-filter" value="Travelata" checked><label for="filter-17">Travelata</label></div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item"><div class="legend-dot a"></div> –ì—Ä—É–ø–ø–∞ A (–∫–æ–Ω—Ç—Ä–æ–ª—å)</div>
            <div class="legend-item"><div class="legend-dot b"></div> –ì—Ä—É–ø–ø–∞ B (—Å–∫–∏–¥–∫–∞)</div>
        </div>
        
        <h3 style="text-align: center; margin-bottom: 10px;">üìä –°–ø–ª–∏—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∏—Å–∫–∞)</h3>
        <div class="split-bar">
            <div class="a" style="width: 10.0%">10.0%</div>
            <div class="b" style="width: 90.0%">90.0%</div>
        </div>
        
        <div class="target-card">
            <h2>üéØ TARGET: RPV +5%</h2>
            <div class="status">‚ùå –ù–ï –î–û–°–¢–ò–ì–ù–£–¢</div>
            <div class="details">–§–∞–∫—Ç: -19.1%</div>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="label">üìà CVR (–ö–æ–Ω–≤–µ—Ä—Å–∏—è)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">0.41%</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">0.35%</div>
                    </div>
                </div>
                <div class="lift negative">-13.8%</div>
            </div>
            
            <div class="metric-card">
                <div class="label">üí∞ RPV (Revenue Per Visitor)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">744‚ÇΩ</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">602‚ÇΩ</div>
                    </div>
                </div>
                <div class="lift negative">-19.1%</div>
            </div>
            
            <div class="metric-card">
                <div class="label">üßæ AOV (–°—Ä–µ–¥–Ω–∏–π —á–µ–∫)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">181,144‚ÇΩ</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">169,963‚ÇΩ</div>
                    </div>
                </div>
                <div class="lift negative">-6.2%</div>
            </div>
            
            <div class="metric-card">
                <div class="label">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∏—Å–∫–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">40,907</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">369,517</div>
                    </div>
                </div>
                <div class="lift positive">–í—Å–µ–≥–æ: 410,424</div>
            </div>
        </div>
        
        <!-- –î–Ω–µ–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É -->
        <div class="daily-charts-grid">
            <div class="chart-card">
                <h3>üìä –ó–∞–∫–∞–∑—ã –ø–æ –¥–Ω—è–º</h3>
                <div id="ordersChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üí≥ –û–ø–ª–∞—Ç—ã –ø–æ –¥–Ω—è–º</h3>
                <div id="paymentsChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üß≠ –ö–æ–Ω–≤–µ—Ä—Å–∏—è: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Üí –æ–ø–ª–∞—Ç—ã (CVR, %)</h3>
                <div id="cvrUsersChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üí≥ –ö–æ–Ω–≤–µ—Ä—Å–∏—è: –∑–∞–∫–∞–∑ ‚Üí –æ–ø–ª–∞—Ç–∞ (Pay-through, %)</h3>
                <div id="payRateChart" class="chart"></div>
            </div>
        </div>
        
        <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ -->
        <div class="charts-grid">
            <div class="chart-card">
                <h3>üìà CVR (–ø–æ–∏—Å–∫ ‚Üí –æ–ø–ª–∞—Ç–∞), bps</h3>
                <div id="metricsCvrChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üí∞ RPV (‚ÇΩ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∏—Å–∫–∞)</h3>
                <div id="metricsRpvChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üßæ AOV (—Ç—ã—Å. ‚ÇΩ)</h3>
                <div id="metricsAovChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üìâ –í–æ—Ä–æ–Ω–∫–∞ 1: –ü–æ–∏—Å–∫ ‚Üí –ó–∞–∫–∞–∑—ã (% –æ—Ç –ø–æ–∏—Å–∫–∞)</h3>
                <div id="funnelChart1" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üìâ –í–æ—Ä–æ–Ω–∫–∞ 2: –ó–∞–∫–∞–∑—ã ‚Üí –û–ø–ª–∞—Ç—ã (% –æ—Ç –∑–∞–∫–∞–∑–æ–≤)</h3>
                <div id="funnelChart2" class="chart"></div>
            </div>
        </div>
        
        <div class="chart-card">
            <h3>üìã –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <table class="funnel-table">
                <tr>
                    <th>–ú–µ—Ç—Ä–∏–∫–∞</th>
                    <th>–ì—Ä—É–ø–ø–∞ A</th>
                    <th>–ì—Ä—É–ø–ø–∞ B</th>
                    <th>Œî –∞–±—Å.</th>
                    <th>Œî –æ—Ç–Ω.</th>
                </tr>
                <tr>
                    <td>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ–∏—Å–∫)</td>
                    <td>40,907</td>
                    <td>369,517</td>
                    <td>+328,610</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td>–ó–∞–∫–∞–∑–æ–≤</td>
                    <td>669</td>
                    <td>6,130</td>
                    <td>+5,461</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td>–û–ø–ª–∞—Ç</td>
                    <td>168</td>
                    <td>1,308</td>
                    <td>+1,140</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td>–í—ã—Ä—É—á–∫–∞</td>
                    <td>30,432,187‚ÇΩ</td>
                    <td>222,311,416‚ÇΩ</td>
                    <td>+191,879,229‚ÇΩ</td>
                    <td>‚Äî</td>
                </tr>
                <tr style="font-weight: bold; background: rgba(255,255,255,0.05);">
                    <td>CVR</td>
                    <td>0.41%</td>
                    <td>0.35%</td>
                    <td style="color: #e74c3c">-0.06%</td>
                    <td style="color: #e74c3c">-13.8%</td>
                </tr>
                <tr style="font-weight: bold; background: rgba(255,255,255,0.05);">
                    <td>RPV</td>
                    <td>744‚ÇΩ</td>
                    <td>602‚ÇΩ</td>
                    <td style="color: #e74c3c">-142‚ÇΩ</td>
                    <td style="color: #e74c3c">-19.1%</td>
                </tr>
                <tr style="font-weight: bold; background: rgba(255,255,255,0.05);">
                    <td>AOV</td>
                    <td>181,144‚ÇΩ</td>
                    <td>169,963‚ÇΩ</td>
                    <td style="color: #e74c3c">-11,181‚ÇΩ</td>
                    <td style="color: #e74c3c">-6.2%</td>
                </tr>
            </table>
        </div>
        
        <div class="footer">
            –û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: 2026-01-26 08:12:09 | WorkOS AB Test Dashboard
        </div>
    </div>
    
    <script>
        // Helper function to normalize date to 'YYYY-MM-DD' format
        function normalizeDate(date) {
            if (!date) return null;
            if (typeof date === 'string') {
                // If already string, extract YYYY-MM-DD part
                return date.substring(0, 10);
            }
            if (date instanceof Date) {
                // If Date object, format it
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }
            // Try to convert to string and extract date part
            return String(date).substring(0, 10);
        }
        
        // Store data with tour operators for filtering
        const rawData = {
            df: [{"variant": "a", "tour_operator": "AleanTour", "total_orders": 1, "unique_users": 1, "paid_orders": 1, "total_gmv": 60888.0, "paid_revenue": 60888.0, "avg_paid_order_value": 60888.0}, {"variant": "a", "tour_operator": "Anex", "total_orders": 37, "unique_users": 29, "paid_orders": 15, "total_gmv": 8675642.0, "paid_revenue": 4002979.0, "avg_paid_order_value": 266865.26666666666}, {"variant": "a", "tour_operator": "Biblio Globus", "total_orders": 104, "unique_users": 73, "paid_orders": 28, "total_gmv": 19429692.0, "paid_revenue": 4973236.0, "avg_paid_order_value": 177615.57142857142}, {"variant": "a", "tour_operator": "Coral Travel", "total_orders": 12, "unique_users": 11, "paid_orders": 3, "total_gmv": 2214375.0, "paid_revenue": 415521.0, "avg_paid_order_value": 138507.0}, {"variant": "a", "tour_operator": "FUN&SUN", "total_orders": 55, "unique_users": 45, "paid_orders": 20, "total_gmv": 10710233.0, "paid_revenue": 3248265.0, "avg_paid_order_value": 162413.25}, {"variant": "a", "tour_operator": "ICS Travel Group", "total_orders": 64, "unique_users": 39, "paid_orders": 13, "total_gmv": 10863141.0, "paid_revenue": 2471273.0, "avg_paid_order_value": 190097.92307692306}, {"variant": "a", "tour_operator": "Intourist", "total_orders": 24, "unique_users": 21, "paid_orders": 5, "total_gmv": 4296426.0, "paid_revenue": 753448.0, "avg_paid_order_value": 150689.6}, {"variant": "a", "tour_operator": "Let‚Äôs Fly", "total_orders": 28, "unique_users": 17, "paid_orders": 3, "total_gmv": 5343665.0, "paid_revenue": 320167.0, "avg_paid_order_value": 106722.33333333333}, {"variant": "a", "tour_operator": "One Touch Travel", "total_orders": 14, "unique_users": 9, "paid_orders": 0, "total_gmv": 3600713.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "a", "tour_operator": "PAKS", "total_orders": 16, "unique_users": 14, "paid_orders": 0, "total_gmv": 3790349.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "a", "tour_operator": "Pegas Touristik", "total_orders": 59, "unique_users": 46, "paid_orders": 14, "total_gmv": 11311299.0, "paid_revenue": 2480510.0, "avg_paid_order_value": 177179.2857142857}, {"variant": "a", "tour_operator": "RussianExpress", "total_orders": 10, "unique_users": 7, "paid_orders": 1, "total_gmv": 1833742.0, "paid_revenue": 121518.0, "avg_paid_order_value": 121518.0}, {"variant": "a", "tour_operator": "Space Travel", "total_orders": 40, "unique_users": 32, "paid_orders": 3, "total_gmv": 9188728.0, "paid_revenue": 499183.0, "avg_paid_order_value": 166394.33333333334}, {"variant": "a", "tour_operator": "Sunmar", "total_orders": 56, "unique_users": 40, "paid_orders": 16, "total_gmv": 11352770.0, "paid_revenue": 3090423.0, "avg_paid_order_value": 193151.4375}, {"variant": "a", "tour_operator": "Tez Tour", "total_orders": 18, "unique_users": 12, "paid_orders": 2, "total_gmv": 5625831.0, "paid_revenue": 569469.0, "avg_paid_order_value": 284734.5}, {"variant": "a", "tour_operator": "Travelata", "total_orders": 131, "unique_users": 94, "paid_orders": 44, "total_gmv": 26398673.0, "paid_revenue": 7425307.0, "avg_paid_order_value": 168756.97727272726}, {"variant": "b", "tour_operator": "AleanTour", "total_orders": 33, "unique_users": 17, "paid_orders": 2, "total_gmv": 3731715.0, "paid_revenue": 212547.0, "avg_paid_order_value": 106273.5}, {"variant": "b", "tour_operator": "Anex", "total_orders": 436, "unique_users": 308, "paid_orders": 100, "total_gmv": 104640226.0, "paid_revenue": 23272002.0, "avg_paid_order_value": 232720.02}, {"variant": "b", "tour_operator": "Biblio Globus", "total_orders": 992, "unique_users": 700, "paid_orders": 255, "total_gmv": 189379486.0, "paid_revenue": 41994029.0, "avg_paid_order_value": 164682.46666666667}, {"variant": "b", "tour_operator": "China Travel", "total_orders": 2, "unique_users": 1, "paid_orders": 0, "total_gmv": 1099072.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "b", "tour_operator": "Coral Travel", "total_orders": 78, "unique_users": 64, "paid_orders": 15, "total_gmv": 14110046.0, "paid_revenue": 2503745.0, "avg_paid_order_value": 166916.33333333334}, {"variant": "b", "tour_operator": "FUN&SUN", "total_orders": 556, "unique_users": 380, "paid_orders": 117, "total_gmv": 117547643.0, "paid_revenue": 21946030.0, "avg_paid_order_value": 187572.90598290597}, {"variant": "b", "tour_operator": "ICS Travel Group", "total_orders": 448, "unique_users": 298, "paid_orders": 60, "total_gmv": 85831401.0, "paid_revenue": 10678972.0, "avg_paid_order_value": 177982.86666666667}, {"variant": "b", "tour_operator": "IZI Tour", "total_orders": 4, "unique_users": 3, "paid_orders": 0, "total_gmv": 791035.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "b", "tour_operator": "Intourist", "total_orders": 244, "unique_users": 188, "paid_orders": 66, "total_gmv": 48046989.0, "paid_revenue": 11559651.0, "avg_paid_order_value": 175146.22727272726}, {"variant": "b", "tour_operator": "Let‚Äôs Fly", "total_orders": 306, "unique_users": 226, "paid_orders": 23, "total_gmv": 62934066.0, "paid_revenue": 3909668.0, "avg_paid_order_value": 169985.5652173913}, {"variant": "b", "tour_operator": "One Touch Travel", "total_orders": 128, "unique_users": 97, "paid_orders": 7, "total_gmv": 27118534.0, "paid_revenue": 1607120.0, "avg_paid_order_value": 229588.57142857142}, {"variant": "b", "tour_operator": "PAKS", "total_orders": 164, "unique_users": 129, "paid_orders": 15, "total_gmv": 48857165.0, "paid_revenue": 3759413.0, "avg_paid_order_value": 250627.53333333333}, {"variant": "b", "tour_operator": "Pegas Touristik", "total_orders": 578, "unique_users": 403, "paid_orders": 128, "total_gmv": 112078194.0, "paid_revenue": 25496118.0, "avg_paid_order_value": 199188.421875}, {"variant": "b", "tour_operator": "RussianExpress", "total_orders": 93, "unique_users": 69, "paid_orders": 19, "total_gmv": 24735822.0, "paid_revenue": 4345416.0, "avg_paid_order_value": 228706.1052631579}, {"variant": "b", "tour_operator": "Space Travel", "total_orders": 405, "unique_users": 282, "paid_orders": 51, "total_gmv": 80726843.0, "paid_revenue": 8681502.0, "avg_paid_order_value": 170225.5294117647}, {"variant": "b", "tour_operator": "Sunmar", "total_orders": 340, "unique_users": 235, "paid_orders": 80, "total_gmv": 64459873.0, "paid_revenue": 13348887.0, "avg_paid_order_value": 166861.0875}, {"variant": "b", "tour_operator": "Tez Tour", "total_orders": 162, "unique_users": 102, "paid_orders": 17, "total_gmv": 39676127.0, "paid_revenue": 3815806.0, "avg_paid_order_value": 224459.17647058822}, {"variant": "b", "tour_operator": "Travelata", "total_orders": 1161, "unique_users": 812, "paid_orders": 353, "total_gmv": 212401078.0, "paid_revenue": 45180510.0, "avg_paid_order_value": 127990.11331444759}],
            daily_df: [{"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 7, "unique_users": 5, "paid_orders": 3, "paid_revenue": 1304065.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 3, "unique_users": 3, "paid_orders": 1, "paid_revenue": 286245.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 12, "unique_users": 8, "paid_orders": 5, "paid_revenue": 934461.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Let‚Äôs Fly", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 6, "unique_users": 3, "paid_orders": 2, "paid_revenue": 382176.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 5, "unique_users": 5, "paid_orders": 3, "paid_revenue": 418788.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 2, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 13, "unique_users": 8, "paid_orders": 4, "paid_revenue": 508973.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 20, "unique_users": 19, "paid_orders": 6, "paid_revenue": 1258012.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 98, "unique_users": 77, "paid_orders": 27, "paid_revenue": 4251089.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 5, "unique_users": 4, "paid_orders": 2, "paid_revenue": 336835.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 45, "unique_users": 34, "paid_orders": 13, "paid_revenue": 2722743.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 34, "unique_users": 19, "paid_orders": 4, "paid_revenue": 747069.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "IZI Tour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 13, "unique_users": 13, "paid_orders": 4, "paid_revenue": 753581.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 17, "unique_users": 16, "paid_orders": 1, "paid_revenue": 195214.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 7, "unique_users": 6, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 16, "unique_users": 12, "paid_orders": 2, "paid_revenue": 533615.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 44, "unique_users": 36, "paid_orders": 12, "paid_revenue": 2626451.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 18, "unique_users": 11, "paid_orders": 5, "paid_revenue": 1142410.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 25, "unique_users": 18, "paid_orders": 1, "paid_revenue": 291253.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 13, "unique_users": 12, "paid_orders": 4, "paid_revenue": 864695.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 4, "unique_users": 4, "paid_orders": 2, "paid_revenue": 517093.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 89, "unique_users": 67, "paid_orders": 31, "paid_revenue": 4509362.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 6, "unique_users": 5, "paid_orders": 1, "paid_revenue": 357420.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 25, "unique_users": 20, "paid_orders": 8, "paid_revenue": 1502223.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Coral Travel", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 7, "unique_users": 7, "paid_orders": 3, "paid_revenue": 466449.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 13, "unique_users": 9, "paid_orders": 4, "paid_revenue": 696100.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 2, "unique_users": 2, "paid_orders": 1, "paid_revenue": 287907.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Let‚Äôs Fly", "orders": 8, "unique_users": 5, "paid_orders": 1, "paid_revenue": 111299.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "One Touch Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 10, "unique_users": 9, "paid_orders": 1, "paid_revenue": 205213.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "RussianExpress", "orders": 1, "unique_users": 1, "paid_orders": 1, "paid_revenue": 121518.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 5, "unique_users": 5, "paid_orders": 2, "paid_revenue": 218537.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 9, "unique_users": 8, "paid_orders": 1, "paid_revenue": 316982.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 4, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 31, "unique_users": 20, "paid_orders": 11, "paid_revenue": 2072083.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 4, "unique_users": 4, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 77, "unique_users": 61, "paid_orders": 14, "paid_revenue": 2551717.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 208, "unique_users": 155, "paid_orders": 52, "paid_revenue": 8188189.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "China Travel", "orders": 2, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 15, "unique_users": 13, "paid_orders": 4, "paid_revenue": 750313.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 61, "unique_users": 52, "paid_orders": 15, "paid_revenue": 1913675.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 85, "unique_users": 57, "paid_orders": 19, "paid_revenue": 3228237.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 60, "unique_users": 46, "paid_orders": 14, "paid_revenue": 1986838.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 60, "unique_users": 52, "paid_orders": 8, "paid_revenue": 1614830.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 30, "unique_users": 20, "paid_orders": 2, "paid_revenue": 805791.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 32, "unique_users": 26, "paid_orders": 5, "paid_revenue": 1411712.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 113, "unique_users": 82, "paid_orders": 27, "paid_revenue": 5369249.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 17, "unique_users": 13, "paid_orders": 5, "paid_revenue": 927830.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 84, "unique_users": 63, "paid_orders": 12, "paid_revenue": 1952178.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 44, "unique_users": 38, "paid_orders": 17, "paid_revenue": 2443746.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 27, "unique_users": 19, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 207, "unique_users": 165, "paid_orders": 63, "paid_revenue": 8164655.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "AleanTour", "orders": 1, "unique_users": 1, "paid_orders": 1, "paid_revenue": 60888.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 10, "unique_users": 10, "paid_orders": 3, "paid_revenue": 381681.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 24, "unique_users": 19, "paid_orders": 6, "paid_revenue": 756494.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Coral Travel", "orders": 5, "unique_users": 4, "paid_orders": 2, "paid_revenue": 271719.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 9, "unique_users": 9, "paid_orders": 5, "paid_revenue": 716309.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 12, "unique_users": 9, "paid_orders": 6, "paid_revenue": 1326834.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 4, "unique_users": 4, "paid_orders": 1, "paid_revenue": 62114.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "One Touch Travel", "orders": 5, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 6, "unique_users": 5, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 4, "unique_users": 3, "paid_orders": 1, "paid_revenue": 117780.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "RussianExpress", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 11, "unique_users": 10, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 13, "unique_users": 10, "paid_orders": 4, "paid_revenue": 651617.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 3, "unique_users": 3, "paid_orders": 2, "paid_revenue": 569469.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 18, "unique_users": 17, "paid_orders": 8, "paid_revenue": 1191979.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 91, "unique_users": 73, "paid_orders": 24, "paid_revenue": 4994386.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 192, "unique_users": 140, "paid_orders": 51, "paid_revenue": 8543389.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 16, "unique_users": 16, "paid_orders": 3, "paid_revenue": 693347.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 129, "unique_users": 85, "paid_orders": 34, "paid_revenue": 6624001.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 68, "unique_users": 54, "paid_orders": 10, "paid_revenue": 2116851.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 47, "unique_users": 36, "paid_orders": 19, "paid_revenue": 3704269.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 43, "unique_users": 35, "paid_orders": 2, "paid_revenue": 373953.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 14, "unique_users": 13, "paid_orders": 2, "paid_revenue": 469827.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 27, "unique_users": 26, "paid_orders": 4, "paid_revenue": 1054214.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 119, "unique_users": 83, "paid_orders": 26, "paid_revenue": 4723820.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 16, "unique_users": 14, "paid_orders": 1, "paid_revenue": 137761.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 86, "unique_users": 65, "paid_orders": 15, "paid_revenue": 2853464.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 66, "unique_users": 45, "paid_orders": 15, "paid_revenue": 2878106.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 35, "unique_users": 24, "paid_orders": 4, "paid_revenue": 874080.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 223, "unique_users": 157, "paid_orders": 63, "paid_revenue": 8550722.0}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 6, "unique_users": 5, "paid_orders": 3, "paid_revenue": 650098.0}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 9, "unique_users": 9, "paid_orders": 3, "paid_revenue": 444902.0}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Coral Travel", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 6, "unique_users": 5, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 15, "unique_users": 12, "paid_orders": 1, "paid_revenue": 98125.0}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 4, "unique_users": 3, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Let‚Äôs Fly", "orders": 6, "unique_users": 4, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 4, "unique_users": 4, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 12, "unique_users": 8, "paid_orders": 1, "paid_revenue": 111230.0}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 8, "unique_users": 5, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 12, "unique_users": 8, "paid_orders": 2, "paid_revenue": 356015.0}, {"date": "2026-01-23 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 32, "unique_users": 22, "paid_orders": 11, "paid_revenue": 1712843.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 103, "unique_users": 74, "paid_orders": 26, "paid_revenue": 7657434.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 163, "unique_users": 125, "paid_orders": 43, "paid_revenue": 6988832.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 19, "unique_users": 15, "paid_orders": 3, "paid_revenue": 344328.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 104, "unique_users": 77, "paid_orders": 24, "paid_revenue": 4290046.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 80, "unique_users": 58, "paid_orders": 13, "paid_revenue": 2172081.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 43, "unique_users": 35, "paid_orders": 12, "paid_revenue": 2279444.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 39, "unique_users": 33, "paid_orders": 3, "paid_revenue": 330897.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 17, "unique_users": 15, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 19, "unique_users": 17, "paid_orders": 3, "paid_revenue": 533632.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 113, "unique_users": 82, "paid_orders": 28, "paid_revenue": 5673492.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 21, "unique_users": 14, "paid_orders": 5, "paid_revenue": 1146584.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 64, "unique_users": 44, "paid_orders": 8, "paid_revenue": 1196734.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 75, "unique_users": 47, "paid_orders": 17, "paid_revenue": 2974240.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 28, "unique_users": 18, "paid_orders": 4, "paid_revenue": 986447.0}, {"date": "2026-01-23 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 188, "unique_users": 151, "paid_orders": 66, "paid_revenue": 8678730.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 4, "unique_users": 4, "paid_orders": 3, "paid_revenue": 953845.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 17, "unique_users": 13, "paid_orders": 2, "paid_revenue": 477729.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Coral Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 7, "unique_users": 7, "paid_orders": 1, "paid_revenue": 171094.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 16, "unique_users": 11, "paid_orders": 2, "paid_revenue": 350214.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 3, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Let‚Äôs Fly", "orders": 9, "unique_users": 6, "paid_orders": 1, "paid_revenue": 144189.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "One Touch Travel", "orders": 7, "unique_users": 5, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 11, "unique_users": 9, "paid_orders": 3, "paid_revenue": 530149.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "RussianExpress", "orders": 3, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 7, "unique_users": 6, "paid_orders": 1, "paid_revenue": 280646.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 6, "unique_users": 5, "paid_orders": 1, "paid_revenue": 189979.0}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 5, "unique_users": 3, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 19, "unique_users": 16, "paid_orders": 6, "paid_revenue": 1094240.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 7, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 61, "unique_users": 48, "paid_orders": 14, "paid_revenue": 2727240.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 153, "unique_users": 113, "paid_orders": 39, "paid_revenue": 7351873.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 8, "unique_users": 7, "paid_orders": 2, "paid_revenue": 245614.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 104, "unique_users": 69, "paid_orders": 21, "paid_revenue": 4128481.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 72, "unique_users": 60, "paid_orders": 8, "paid_revenue": 1100679.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "IZI Tour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 38, "unique_users": 34, "paid_orders": 9, "paid_revenue": 1428596.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 45, "unique_users": 32, "paid_orders": 2, "paid_revenue": 503741.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 26, "unique_users": 23, "paid_orders": 3, "paid_revenue": 331502.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 33, "unique_users": 25, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 93, "unique_users": 74, "paid_orders": 20, "paid_revenue": 4282138.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 8, "unique_users": 8, "paid_orders": 2, "paid_revenue": 584900.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 63, "unique_users": 51, "paid_orders": 8, "paid_revenue": 1192262.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 63, "unique_users": 47, "paid_orders": 12, "paid_revenue": 1906444.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 30, "unique_users": 21, "paid_orders": 5, "paid_revenue": 864691.0}, {"date": "2026-01-24 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 185, "unique_users": 143, "paid_orders": 60, "paid_revenue": 7100552.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 4, "unique_users": 3, "paid_orders": 2, "paid_revenue": 355870.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 26, "unique_users": 18, "paid_orders": 8, "paid_revenue": 1505643.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Coral Travel", "orders": 2, "unique_users": 2, "paid_orders": 1, "paid_revenue": 143802.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 11, "unique_users": 9, "paid_orders": 4, "paid_revenue": 691786.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 7, "unique_users": 4, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 9, "unique_users": 9, "paid_orders": 3, "paid_revenue": 403427.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Let‚Äôs Fly", "orders": 4, "unique_users": 3, "paid_orders": 1, "paid_revenue": 64679.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "One Touch Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 14, "unique_users": 14, "paid_orders": 6, "paid_revenue": 1133962.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "RussianExpress", "orders": 3, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 7, "unique_users": 5, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 10, "unique_users": 8, "paid_orders": 5, "paid_revenue": 1157042.0}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 3, "unique_users": 3, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 16, "unique_users": 14, "paid_orders": 4, "paid_revenue": 845189.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 15, "unique_users": 5, "paid_orders": 2, "paid_revenue": 212547.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 77, "unique_users": 47, "paid_orders": 16, "paid_revenue": 4083213.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 150, "unique_users": 127, "paid_orders": 42, "paid_revenue": 6515572.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 14, "unique_users": 10, "paid_orders": 1, "paid_revenue": 133308.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 95, "unique_users": 68, "paid_orders": 10, "paid_revenue": 2267084.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 97, "unique_users": 72, "paid_orders": 6, "paid_revenue": 1314055.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "IZI Tour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 34, "unique_users": 26, "paid_orders": 7, "paid_revenue": 1339706.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 87, "unique_users": 63, "paid_orders": 7, "paid_revenue": 891033.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 28, "unique_users": 23, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 29, "unique_users": 25, "paid_orders": 1, "paid_revenue": 226240.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 88, "unique_users": 71, "paid_orders": 15, "paid_revenue": 2820968.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 13, "unique_users": 11, "paid_orders": 1, "paid_revenue": 405931.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 74, "unique_users": 57, "paid_orders": 7, "paid_revenue": 1195611.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 71, "unique_users": 57, "paid_orders": 15, "paid_revenue": 2281656.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 31, "unique_users": 23, "paid_orders": 2, "paid_revenue": 573495.0}, {"date": "2026-01-25 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 230, "unique_users": 175, "paid_orders": 60, "paid_revenue": 7162316.0}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 3, "unique_users": 3, "paid_orders": 2, "paid_revenue": 268166.0}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "RussianExpress", "orders": 2, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 7, "unique_users": 6, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 28, "unique_users": 25, "paid_orders": 1, "paid_revenue": 155085.0}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 18, "unique_users": 18, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 12, "unique_users": 11, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "IZI Tour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 9, "unique_users": 7, "paid_orders": 1, "paid_revenue": 67217.0}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 15, "unique_users": 9, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 6, "unique_users": 6, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 8, "unique_users": 4, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 8, "unique_users": 7, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 9, "unique_users": 7, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 8, "unique_users": 8, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 7, "unique_users": 5, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-26 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 39, "unique_users": 31, "paid_orders": 10, "paid_revenue": 1014173.0}],
            dates: ["2026-01-20", "2026-01-21", "2026-01-22", "2026-01-23", "2026-01-24", "2026-01-25", "2026-01-26"]
        };
        
        // Normalize dates in rawData
        rawData.dates = rawData.dates.map(normalizeDate);
        rawData.daily_df.forEach(row => {
            row.date = normalizeDate(row.date);
        });
        
        // Filter function
        function filterByTourOperators(selectedOperators) {
            if (selectedOperators.length === 0) {
                return {
                    aggregated: {},
                    dailyAggregated: [],
                    dates: rawData.dates
                };
            }
            
            // Filter main data
            const filteredDf = rawData.df.filter(row => 
                row.tour_operator && selectedOperators.includes(row.tour_operator)
            );
            
            // Filter daily data
            const filteredDailyDf = rawData.daily_df.filter(row => 
                row.tour_operator && selectedOperators.includes(row.tour_operator)
            );
            
            // Aggregate by variant
            const aggregated = {};
            filteredDf.forEach(row => {
                if (!row.variant) return;
                if (!aggregated[row.variant]) {
                    aggregated[row.variant] = {
                        total_orders: 0,
                        unique_users: 0,
                        paid_orders: 0,
                        total_gmv: 0,
                        paid_revenue: 0
                    };
                }
                aggregated[row.variant].total_orders += Number(row.total_orders) || 0;
                aggregated[row.variant].unique_users += Number(row.unique_users) || 0;
                aggregated[row.variant].paid_orders += Number(row.paid_orders) || 0;
                aggregated[row.variant].total_gmv += Number(row.total_gmv) || 0;
                aggregated[row.variant].paid_revenue += Number(row.paid_revenue) || 0;
            });
            
            // Calculate AOV
            Object.keys(aggregated).forEach(variant => {
                aggregated[variant].avg_paid_order_value = 
                    aggregated[variant].paid_orders > 0 
                        ? aggregated[variant].paid_revenue / aggregated[variant].paid_orders 
                        : 0;
            });
            
            // Aggregate daily data by date and variant
            const dailyAggregated = {};
            filteredDailyDf.forEach(row => {
                if (!row.date || !row.variant) return;
                const normalizedDate = normalizeDate(row.date);
                const key = `${normalizedDate}_${row.variant}`;
                if (!dailyAggregated[key]) {
                    dailyAggregated[key] = {
                        date: normalizedDate,
                        variant: row.variant,
                        orders: 0,
                        unique_users: 0,
                        paid_orders: 0,
                        paid_revenue: 0
                    };
                }
                dailyAggregated[key].orders += Number(row.orders) || 0;
                dailyAggregated[key].unique_users += Number(row.unique_users) || 0;
                dailyAggregated[key].paid_orders += Number(row.paid_orders) || 0;
                dailyAggregated[key].paid_revenue += Number(row.paid_revenue) || 0;
            });
            
            return {
                aggregated,
                dailyAggregated: Object.values(dailyAggregated),
                dates: rawData.dates
            };
        }
        
        // Update charts based on selected tour operators
        function updateCharts() {
            const checkboxes = document.querySelectorAll('.tour-operator-filter:checked');
            const selectedOperators = Array.from(checkboxes).map(cb => cb.value);
            
            if (selectedOperators.length === 0) {
                return;
            }
            
            const filtered = filterByTourOperators(selectedOperators);
            
            if (Object.keys(filtered.aggregated).length === 0) {
                return;
            }
            
            const aData = filtered.aggregated['a'] || {};
            const bData = filtered.aggregated['b'] || {};
            
            // Calculate metrics
            const users_search_a = 40907;
            const users_search_b = 369517;
            const paid_a = aData.paid_orders || 0;
            const paid_b = bData.paid_orders || 0;
            const orders_a = aData.total_orders || 0;
            const orders_b = bData.total_orders || 0;
            const revenue_a = aData.paid_revenue || 0;
            const revenue_b = bData.paid_revenue || 0;
            
            const cvr_a = users_search_a > 0 ? (paid_a / users_search_a * 100) : 0;
            const cvr_b = users_search_b > 0 ? (paid_b / users_search_b * 100) : 0;
            const rpv_a = users_search_a > 0 ? (revenue_a / users_search_a) : 0;
            const rpv_b = users_search_b > 0 ? (revenue_b / users_search_b) : 0;
            const aov_a = paid_a > 0 ? (revenue_a / paid_a) : 0;
            const aov_b = paid_b > 0 ? (revenue_b / paid_b) : 0;
            
            // Prepare daily data - normalize dates for comparison
            const dailyA = filtered.dailyAggregated
                .filter(r => r.variant === 'a')
                .map(r => ({ ...r, date: normalizeDate(r.date) }))
                .sort((a, b) => (a.date || '').localeCompare(b.date || ''));
            const dailyB = filtered.dailyAggregated
                .filter(r => r.variant === 'b')
                .map(r => ({ ...r, date: normalizeDate(r.date) }))
                .sort((a, b) => (a.date || '').localeCompare(b.date || ''));
            
            const dates = filtered.dates.map(normalizeDate);
            const orders_a_daily = dates.map(d => {
                const normalizedD = normalizeDate(d);
                const dayData = dailyA.find(r => normalizeDate(r.date) === normalizedD);
                return dayData ? (Number(dayData.orders) || 0) : 0;
            });
            const orders_b_daily = dates.map(d => {
                const normalizedD = normalizeDate(d);
                const dayData = dailyB.find(r => normalizeDate(r.date) === normalizedD);
                return dayData ? (Number(dayData.orders) || 0) : 0;
            });
            const paid_a_daily = dates.map(d => {
                const normalizedD = normalizeDate(d);
                const dayData = dailyA.find(r => normalizeDate(r.date) === normalizedD);
                return dayData ? (Number(dayData.paid_orders) || 0) : 0;
            });
            const paid_b_daily = dates.map(d => {
                const normalizedD = normalizeDate(d);
                const dayData = dailyB.find(r => normalizeDate(r.date) === normalizedD);
                return dayData ? (Number(dayData.paid_orders) || 0) : 0;
            });
            
            const search_users_a_daily = [4382, 11286, 9516, 9444, 8878, 9316, 3150];
            const search_users_b_daily = [39966, 102515, 86037, 85316, 79288, 83834, 27834];
            
            const cvr_users_a_daily = paid_a_daily.map((p, i) => {
                const paid = Number(p) || 0;
                const users = Number(search_users_a_daily[i]) || 0;
                return users > 0 ? (paid / users * 100) : 0;
            });
            const cvr_users_b_daily = paid_b_daily.map((p, i) => {
                const paid = Number(p) || 0;
                const users = Number(search_users_b_daily[i]) || 0;
                return users > 0 ? (paid / users * 100) : 0;
            });
            const payrate_a_daily = orders_a_daily.map((o, i) => {
                const orders = Number(o) || 0;
                const paid = Number(paid_a_daily[i]) || 0;
                return orders > 0 ? (paid / orders * 100) : 0;
            });
            const payrate_b_daily = orders_b_daily.map((o, i) => {
                const orders = Number(o) || 0;
                const paid = Number(paid_b_daily[i]) || 0;
                return orders > 0 ? (paid / orders * 100) : 0;
            });
            
            // Calculate additional metrics
            const orders_pct_a = users_search_a > 0 ? (orders_a / users_search_a * 100) : 0;
            const orders_pct_b = users_search_b > 0 ? (orders_b / users_search_b * 100) : 0;
            const pay_through_pct_a = orders_a > 0 ? (paid_a / orders_a * 100) : 0;
            const pay_through_pct_b = orders_b > 0 ? (paid_b / orders_b * 100) : 0;
            const cvr_lift = cvr_a > 0 ? ((cvr_b - cvr_a) / cvr_a * 100) : 0;
            const rpv_lift = rpv_a > 0 ? ((rpv_b - rpv_a) / rpv_a * 100) : 0;
            const aov_lift = aov_a > 0 ? ((aov_b - aov_a) / aov_a * 100) : 0;
            
            // Update HTML elements (metrics cards, table, split bar)
            updateMetricsDisplay({
                cvr_a, cvr_b, cvr_lift,
                rpv_a, rpv_b, rpv_lift,
                aov_a, aov_b, aov_lift,
                users_search_a, users_search_b,
                orders_a, orders_b,
                paid_a, paid_b,
                revenue_a, revenue_b
            });
            
            // Redraw all charts completely
            Plotly.redraw('ordersChart');
            Plotly.react('ordersChart', [
                {
                    x: dates,
                    y: orders_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: dates,
                    y: orders_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–ó–∞–∫–∞–∑—ã' }
            }, { responsive: true });
            
            Plotly.react('paymentsChart', [
                {
                    x: dates,
                    y: paid_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#3498db', width: 3 },
                    marker: { size: 8 }
                },
                {
                    x: dates,
                    y: paid_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#9b59b6', width: 3 },
                    marker: { size: 8 }
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–û–ø–ª–∞—Ç—ã' }
            }, { responsive: true });
            
            Plotly.react('cvrUsersChart', [
                {
                    x: dates,
                    y: cvr_users_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#3498db', width: 3 },
                    marker: { size: 8 },
                    hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
                },
                {
                    x: dates,
                    y: cvr_users_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#9b59b6', width: 3 },
                    marker: { size: 8 },
                    hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 60 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR', ticksuffix: '%' }
            }, { responsive: true });
            
            Plotly.react('payRateChart', [
                {
                    x: dates,
                    y: payrate_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#3498db', width: 3 },
                    marker: { size: 8 },
                    text: payrate_a_daily,
                    hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
                },
                {
                    x: dates,
                    y: payrate_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#9b59b6', width: 3 },
                    marker: { size: 8 },
                    hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 60 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'Pay-through', ticksuffix: '%' }
            }, { responsive: true });
            
            Plotly.react('metricsCvrChart', [
                {
                    x: ['CVR (bps)'],
                    y: [cvr_a * 100],
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: ['CVR (bps)'],
                    y: [cvr_b * 100],
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR (bps)' }
            }, { responsive: true });
            
            Plotly.react('metricsRpvChart', [
                {
                    x: ['RPV (‚ÇΩ)'],
                    y: [rpv_a],
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: ['RPV (‚ÇΩ)'],
                    y: [rpv_b],
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'RPV, ‚ÇΩ' }
            }, { responsive: true });
            
            Plotly.react('metricsAovChart', [
                {
                    x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                    y: [aov_a / 1000],
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                    y: [aov_b / 1000],
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'AOV, —Ç—ã—Å. ‚ÇΩ' }
            }, { responsive: true });
            
            Plotly.react('funnelChart1', [
                {
                    type: 'funnel',
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                    x: [100, orders_pct_a],
                    text: [String(users_search_a).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(orders_a).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#3498db' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
                },
                {
                    type: 'funnel',
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                    x: [100, orders_pct_b],
                    text: [String(users_search_b).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(orders_b).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#9b59b6' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 20, l: 100 },
                legend: { orientation: 'h', y: -0.1 },
                funnelmode: 'group'
            }, { responsive: true });
            
            Plotly.react('funnelChart2', [
                {
                    type: 'funnel',
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                    x: [100, pay_through_pct_a],
                    text: [String(orders_a).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(paid_a).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#3498db' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
                },
                {
                    type: 'funnel',
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                    x: [100, pay_through_pct_b],
                    text: [String(orders_b).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(paid_b).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#9b59b6' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 20, l: 100 },
                legend: { orientation: 'h', y: -0.1 },
                funnelmode: 'group'
            }, { responsive: true });
        }
        
        // Update HTML metrics display
        function updateMetricsDisplay(metrics) {
            // Update metric cards - use more specific selectors
            const metricsGrid = document.querySelector('.metrics-grid');
            if (metricsGrid) {
                const metricCards = metricsGrid.querySelectorAll('.metric-card');
                
                // CVR card (first card)
                if (metricCards[0]) {
                    const cvrCard = metricCards[0];
                    const valueA = cvrCard.querySelector('.value-box.a .value');
                    const valueB = cvrCard.querySelector('.value-box.b .value');
                    const liftEl = cvrCard.querySelector('.lift');
                    if (valueA) valueA.textContent = metrics.cvr_a.toFixed(2) + '%';
                    if (valueB) valueB.textContent = metrics.cvr_b.toFixed(2) + '%';
                    if (liftEl) {
                        liftEl.textContent = (metrics.cvr_lift >= 0 ? '+' : '') + metrics.cvr_lift.toFixed(1) + '%';
                        liftEl.className = 'lift ' + (metrics.cvr_lift < 0 ? 'negative' : 'positive');
                    }
                }
                
                // RPV card (second card)
                if (metricCards[1]) {
                    const rpvCard = metricCards[1];
                    const valueA = rpvCard.querySelector('.value-box.a .value');
                    const valueB = rpvCard.querySelector('.value-box.b .value');
                    const liftEl = rpvCard.querySelector('.lift');
                    if (valueA) valueA.textContent = Math.round(metrics.rpv_a).toLocaleString('ru-RU') + '‚ÇΩ';
                    if (valueB) valueB.textContent = Math.round(metrics.rpv_b).toLocaleString('ru-RU') + '‚ÇΩ';
                    if (liftEl) {
                        liftEl.textContent = (metrics.rpv_lift >= 0 ? '+' : '') + metrics.rpv_lift.toFixed(1) + '%';
                        liftEl.className = 'lift ' + (metrics.rpv_lift < 0 ? 'negative' : 'positive');
                    }
                }
                
                // AOV card (third card)
                if (metricCards[2]) {
                    const aovCard = metricCards[2];
                    const valueA = aovCard.querySelector('.value-box.a .value');
                    const valueB = aovCard.querySelector('.value-box.b .value');
                    const liftEl = aovCard.querySelector('.lift');
                    if (valueA) valueA.textContent = Math.round(metrics.aov_a).toLocaleString('ru-RU') + '‚ÇΩ';
                    if (valueB) valueB.textContent = Math.round(metrics.aov_b).toLocaleString('ru-RU') + '‚ÇΩ';
                    if (liftEl) {
                        liftEl.textContent = (metrics.aov_lift >= 0 ? '+' : '') + metrics.aov_lift.toFixed(1) + '%';
                        liftEl.className = 'lift ' + (metrics.aov_lift < 0 ? 'negative' : 'positive');
                    }
                }
            }
            
            // Update target card
            const targetCard = document.querySelector('.target-card');
            if (targetCard) {
                const statusEl = targetCard.querySelector('.status');
                const detailsEl = targetCard.querySelector('.details');
                if (metrics.rpv_lift >= 5) {
                    statusEl.textContent = '‚úÖ –î–û–°–¢–ò–ì–ù–£–¢';
                    statusEl.style.color = '#27ae60';
                } else {
                    statusEl.textContent = '‚ùå –ù–ï –î–û–°–¢–ò–ì–ù–£–¢';
                    statusEl.style.color = '#e74c3c';
                }
                detailsEl.textContent = '–§–∞–∫—Ç: ' + (metrics.rpv_lift >= 0 ? '+' : '') + metrics.rpv_lift.toFixed(1) + '%';
            }
            
            // Update split bar
            const totalUsers = metrics.users_search_a + metrics.users_search_b;
            if (totalUsers > 0) {
                const splitA = document.querySelector('.split-bar .a');
                const splitB = document.querySelector('.split-bar .b');
                if (splitA && splitB) {
                    const pctA = (metrics.users_search_a / totalUsers * 100).toFixed(1);
                    const pctB = (metrics.users_search_b / totalUsers * 100).toFixed(1);
                    splitA.style.width = pctA + '%';
                    splitA.textContent = pctA + '%';
                    splitB.style.width = pctB + '%';
                    splitB.textContent = pctB + '%';
                }
            }
            
            // Update table
            const tableRows = document.querySelectorAll('.funnel-table tr');
            if (tableRows.length >= 8) {  // Header + 7 data rows
                // Users row
                tableRows[1].cells[1].textContent = metrics.users_search_a.toLocaleString('ru-RU');
                tableRows[1].cells[2].textContent = metrics.users_search_b.toLocaleString('ru-RU');
                tableRows[1].cells[3].textContent = '+' + (metrics.users_search_b - metrics.users_search_a).toLocaleString('ru-RU');
                
                // Orders row
                tableRows[2].cells[1].textContent = metrics.orders_a.toLocaleString('ru-RU');
                tableRows[2].cells[2].textContent = metrics.orders_b.toLocaleString('ru-RU');
                tableRows[2].cells[3].textContent = '+' + (metrics.orders_b - metrics.orders_a).toLocaleString('ru-RU');
                
                // Paid row
                tableRows[3].cells[1].textContent = metrics.paid_a.toLocaleString('ru-RU');
                tableRows[3].cells[2].textContent = metrics.paid_b.toLocaleString('ru-RU');
                tableRows[3].cells[3].textContent = '+' + (metrics.paid_b - metrics.paid_a).toLocaleString('ru-RU');
                
                // Revenue row
                tableRows[4].cells[1].textContent = Math.round(metrics.revenue_a).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[4].cells[2].textContent = Math.round(metrics.revenue_b).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[4].cells[3].textContent = '+' + Math.round(metrics.revenue_b - metrics.revenue_a).toLocaleString('ru-RU') + '‚ÇΩ';
                
                // CVR row
                const cvrDiff = metrics.cvr_b - metrics.cvr_a;
                tableRows[5].cells[1].textContent = metrics.cvr_a.toFixed(2) + '%';
                tableRows[5].cells[2].textContent = metrics.cvr_b.toFixed(2) + '%';
                tableRows[5].cells[3].textContent = (cvrDiff >= 0 ? '+' : '') + cvrDiff.toFixed(2) + '%';
                tableRows[5].cells[3].style.color = cvrDiff < 0 ? '#e74c3c' : '#27ae60';
                tableRows[5].cells[4].textContent = (metrics.cvr_lift >= 0 ? '+' : '') + metrics.cvr_lift.toFixed(1) + '%';
                tableRows[5].cells[4].style.color = metrics.cvr_lift < 0 ? '#e74c3c' : '#27ae60';
                
                // RPV row
                const rpvDiff = metrics.rpv_b - metrics.rpv_a;
                tableRows[6].cells[1].textContent = Math.round(metrics.rpv_a).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[6].cells[2].textContent = Math.round(metrics.rpv_b).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[6].cells[3].textContent = (rpvDiff >= 0 ? '+' : '') + Math.round(rpvDiff).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[6].cells[3].style.color = rpvDiff < 0 ? '#e74c3c' : '#27ae60';
                tableRows[6].cells[4].textContent = (metrics.rpv_lift >= 0 ? '+' : '') + metrics.rpv_lift.toFixed(1) + '%';
                tableRows[6].cells[4].style.color = metrics.rpv_lift < 0 ? '#e74c3c' : '#27ae60';
                
                // AOV row
                const aovDiff = metrics.aov_b - metrics.aov_a;
                tableRows[7].cells[1].textContent = Math.round(metrics.aov_a).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[7].cells[2].textContent = Math.round(metrics.aov_b).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[7].cells[3].textContent = (aovDiff >= 0 ? '+' : '') + Math.round(aovDiff).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[7].cells[3].style.color = aovDiff < 0 ? '#e74c3c' : '#27ae60';
                tableRows[7].cells[4].textContent = (metrics.aov_lift >= 0 ? '+' : '') + metrics.aov_lift.toFixed(1) + '%';
                tableRows[7].cells[4].style.color = metrics.aov_lift < 0 ? '#e74c3c' : '#27ae60';
            }
        }
        
        // Setup filter event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const allCheckbox = document.getElementById('filter-all');
            const operatorCheckboxes = document.querySelectorAll('.tour-operator-filter');
            
            allCheckbox.addEventListener('change', function() {
                operatorCheckboxes.forEach(cb => {
                    cb.checked = this.checked;
                });
                updateCharts();
            });
            
            operatorCheckboxes.forEach(cb => {
                cb.addEventListener('change', function() {
                    const allChecked = Array.from(operatorCheckboxes).every(c => c.checked);
                    allCheckbox.checked = allChecked;
                    updateCharts();
                });
            });
        });
        
        // Orders chart
        Plotly.newPlot('ordersChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [54, 124, 126, 116, 117, 119, 13],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [450, 1126, 1174, 1078, 990, 1134, 178],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–ó–∞–∫–∞–∑—ã' }
        }, { responsive: true });
        
        // Payments chart
        Plotly.newPlot('paymentsChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [18, 34, 39, 21, 20, 34, 2],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#3498db', width: 3 },
                marker: { size: 8 }
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [114, 257, 273, 255, 205, 192, 12],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9b59b6', width: 3 },
                marker: { size: 8 }
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–û–ø–ª–∞—Ç—ã' }
        }, { responsive: true });
        
        // Metrics comparison chart - CVR in basis points
        Plotly.newPlot('metricsCvrChart', [
            {
                x: ['CVR (bps)'],
                y: [41.068765736915445],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['CVR (bps)'],
                y: [35.39755951688285],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR (bps)' }
        }, { responsive: true });
        
        // Metrics comparison chart - RPV in RUB
        Plotly.newPlot('metricsRpvChart', [
            {
                x: ['RPV (‚ÇΩ)'],
                y: [743.9359278363116],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['RPV (‚ÇΩ)'],
                y: [601.6270320445338],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'RPV, ‚ÇΩ' }
        }, { responsive: true });
        
        // Metrics comparison chart - AOV in thousands RUB
        Plotly.newPlot('metricsAovChart', [
            {
                x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                y: [181.14397023809525],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                y: [169.96285626911313],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'AOV, —Ç—ã—Å. ‚ÇΩ' }
        }, { responsive: true });
        
        // Funnel chart 1: –ü–æ–∏—Å–∫ ‚Üí –ó–∞–∫–∞–∑—ã (–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, % –æ—Ç –ø–æ–∏—Å–∫–∞)
        Plotly.newPlot('funnelChart1', [
            {
                type: 'funnel',
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                x: [100, 1.6354169213093115],
                text: ['40,907', '669'],
                textposition: 'inside',
                marker: { color: '#3498db' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
            },
            {
                type: 'funnel',
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                x: [100, 1.6589223229242496],
                text: ['369,517', '6,130'],
                textposition: 'inside',
                marker: { color: '#9b59b6' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 20, l: 100 },
            legend: { orientation: 'h', y: -0.1 },
            funnelmode: 'group'
        }, { responsive: true });
        
        // Funnel chart 2: –ó–∞–∫–∞–∑—ã ‚Üí –û–ø–ª–∞—Ç—ã (–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, % –æ—Ç –∑–∞–∫–∞–∑–æ–≤)
        Plotly.newPlot('funnelChart2', [
            {
                type: 'funnel',
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                x: [100, 25.112107623318387],
                text: ['669', '168'],
                textposition: 'inside',
                marker: { color: '#3498db' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
            },
            {
                type: 'funnel',
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                x: [100, 21.33768352365416],
                text: ['6,130', '1,308'],
                textposition: 'inside',
                marker: { color: '#9b59b6' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 20, l: 100 },
            legend: { orientation: 'h', y: -0.1 },
            funnelmode: 'group'
        }, { responsive: true });
        
        // CVR users -> paid
        Plotly.newPlot('cvrUsersChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [0.41, 0.3, 0.41, 0.22, 0.23, 0.36, 0.06],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#3498db', width: 3 },
                marker: { size: 8 },
                hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [0.29, 0.25, 0.32, 0.3, 0.26, 0.23, 0.04],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9b59b6', width: 3 },
                marker: { size: 8 },
                hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 60 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR', ticksuffix: '%' }
        }, { responsive: true });
        
        // Pay-through orders -> paid
        Plotly.newPlot('payRateChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [33.33, 27.42, 30.95, 18.1, 17.09, 28.57, 15.38],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#3498db', width: 3 },
                marker: { size: 8 },
                text: [33.33, 27.42, 30.95, 18.1, 17.09, 28.57, 15.38],
                hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22', '2026-01-23', '2026-01-24', '2026-01-25', '2026-01-26'],
                y: [25.33, 22.82, 23.25, 23.65, 20.71, 16.93, 6.74],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9b59b6', width: 3 },
                marker: { size: 8 },
                hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 60 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'Pay-through', ticksuffix: '%' }
        }, { responsive: true });
    </script>

    </div>

    <script src="auth.js"></script>
</body>
</html>
