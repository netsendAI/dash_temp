<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AB-—Ç–µ—Å—Ç IN-4868: –¢–µ–Ω–µ–≤—ã–µ —Å–∫–∏–¥–∫–∏</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        
        .header {
            text-align: center;
            padding: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            margin-bottom: 20px;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header .subtitle { color: #888; font-size: 1.1em; }
        .header .uuid { color: #666; font-size: 0.9em; font-family: monospace; }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            transition: transform 0.3s;
        }
        .metric-card:hover { transform: translateY(-5px); }
        .metric-card .label { color: #888; font-size: 0.9em; margin-bottom: 10px; }
        .metric-card .values {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
        }
        .metric-card .value-box {
            text-align: center;
        }
        .metric-card .value-box .variant { 
            font-size: 0.8em; 
            color: #888;
            margin-bottom: 5px;
        }
        .metric-card .value-box .value { 
            font-size: 1.8em; 
            font-weight: bold;
        }
        .metric-card .value-box.a .value { color: #3498db; }
        .metric-card .value-box.b .value { color: #9b59b6; }
        .metric-card .lift {
            font-size: 1.5em;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
        }
        .metric-card .lift.negative { background: rgba(231, 76, 60, 0.2); color: #e74c3c; }
        .metric-card .lift.positive { background: rgba(39, 174, 96, 0.2); color: #27ae60; }
        
        .target-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border: 2px solid #e74c3c;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        .target-card h2 { margin-bottom: 15px; }
        .target-card .status { font-size: 2em; color: #e74c3c; }
        .target-card .details { color: #888; margin-top: 10px; }
        
        .filter-section {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .filter-section h3 {
            margin-bottom: 15px;
            color: #fff;
        }
        .filter-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .filter-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .filter-checkbox label {
            cursor: pointer;
            user-select: none;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .daily-charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1200px) {
            .daily-charts-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .chart-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 20px;
        }
        .chart-card h3 { margin-bottom: 15px; color: #fff; }
        .chart { height: 300px; }
        
        .split-bar {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            height: 40px;
            display: flex;
            overflow: hidden;
            margin: 20px 0;
        }
        .split-bar .a { background: #3498db; display: flex; align-items: center; justify-content: center; }
        .split-bar .b { background: #9b59b6; display: flex; align-items: center; justify-content: center; }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .legend-dot.a { background: #3498db; }
        .legend-dot.b { background: #9b59b6; }
        
        .funnel-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .funnel-table th, .funnel-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .funnel-table th { color: #888; }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
<!-- –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ -->
    <div id="login-screen">
        <h2>–î–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥—É</h2>
        <p>–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞.</p>
        <input id="login-input" type="text" placeholder="–õ–æ–≥–∏–Ω">
        <input id="password-input" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
        <button id="login-button">–í–æ–π—Ç–∏</button>
        <div id="login-error" style="display:none;color:#e74c3c;font-size:0.85em;margin-top:10px;">–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å</div>
    </div>

    <div id="dashboard" style="display:none;">

    <div class="container">
        <div class="header">
            <h1>üß™ AB-—Ç–µ—Å—Ç: –¢–µ–Ω–µ–≤—ã–µ —Å–∫–∏–¥–∫–∏</h1>
            <div class="subtitle">IN-4868 | –ü–µ—Ä–∏–æ–¥: 2026-01-20 ‚Äî 2026-01-22</div>
            <div class="subtitle" style="margin-top: 5px; font-size: 0.9em;">–í–∏—Ç—Ä–∏–Ω—ã: desktop, android, ios, mobweb (–±–µ–∑ white-label)</div>
            <div class="uuid">UUID: 944ace4b-4521-4191-b02c-112d688c0460</div>
        </div>
        
        <div class="filter-section">
            <h3>üîç –§–∏–ª—å—Ç—Ä –ø–æ —Ç—É—Ä-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º</h3>
            <div class="filter-checkboxes">
                <div class="filter-checkbox">
                    <input type="checkbox" id="filter-all" checked>
                    <label for="filter-all">–í—Å–µ —Ç—É—Ä-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã</label>
                </div>
                <div class="filter-checkbox"><input type="checkbox" id="filter-0" class="tour-operator-filter" value="AleanTour" checked><label for="filter-0">AleanTour</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-1" class="tour-operator-filter" value="Anex" checked><label for="filter-1">Anex</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-2" class="tour-operator-filter" value="Biblio Globus" checked><label for="filter-2">Biblio Globus</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-3" class="tour-operator-filter" value="China Travel" checked><label for="filter-3">China Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-4" class="tour-operator-filter" value="Coral Travel" checked><label for="filter-4">Coral Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-5" class="tour-operator-filter" value="FUN&SUN" checked><label for="filter-5">FUN&SUN</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-6" class="tour-operator-filter" value="ICS Travel Group" checked><label for="filter-6">ICS Travel Group</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-7" class="tour-operator-filter" value="IZI Tour" checked><label for="filter-7">IZI Tour</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-8" class="tour-operator-filter" value="Intourist" checked><label for="filter-8">Intourist</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-9" class="tour-operator-filter" value="Let‚Äôs Fly" checked><label for="filter-9">Let‚Äôs Fly</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-10" class="tour-operator-filter" value="One Touch Travel" checked><label for="filter-10">One Touch Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-11" class="tour-operator-filter" value="PAKS" checked><label for="filter-11">PAKS</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-12" class="tour-operator-filter" value="Pegas Touristik" checked><label for="filter-12">Pegas Touristik</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-13" class="tour-operator-filter" value="RussianExpress" checked><label for="filter-13">RussianExpress</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-14" class="tour-operator-filter" value="Space Travel" checked><label for="filter-14">Space Travel</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-15" class="tour-operator-filter" value="Sunmar" checked><label for="filter-15">Sunmar</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-16" class="tour-operator-filter" value="Tez Tour" checked><label for="filter-16">Tez Tour</label></div><div class="filter-checkbox"><input type="checkbox" id="filter-17" class="tour-operator-filter" value="Travelata" checked><label for="filter-17">Travelata</label></div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item"><div class="legend-dot a"></div> –ì—Ä—É–ø–ø–∞ A (–∫–æ–Ω—Ç—Ä–æ–ª—å)</div>
            <div class="legend-item"><div class="legend-dot b"></div> –ì—Ä—É–ø–ø–∞ B (—Å–∫–∏–¥–∫–∞)</div>
        </div>
        
        <h3 style="text-align: center; margin-bottom: 10px;">üìä –°–ø–ª–∏—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∏—Å–∫–∞)</h3>
        <div class="split-bar">
            <div class="a" style="width: 10.0%">10.0%</div>
            <div class="b" style="width: 90.0%">90.0%</div>
        </div>
        
        <div class="target-card">
            <h2>üéØ TARGET: RPV +5%</h2>
            <div class="status">‚ùå –ù–ï –î–û–°–¢–ò–ì–ù–£–¢</div>
            <div class="details">–§–∞–∫—Ç: -32.5%</div>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="label">üìà CVR (–ö–æ–Ω–≤–µ—Ä—Å–∏—è)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">0.32%</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">0.24%</div>
                    </div>
                </div>
                <div class="lift negative">-25.7%</div>
            </div>
            
            <div class="metric-card">
                <div class="label">üí∞ RPV (Revenue Per Visitor)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">597‚ÇΩ</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">402‚ÇΩ</div>
                    </div>
                </div>
                <div class="lift negative">-32.5%</div>
            </div>
            
            <div class="metric-card">
                <div class="label">üßæ AOV (–°—Ä–µ–¥–Ω–∏–π —á–µ–∫)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">183,987‚ÇΩ</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">167,038‚ÇΩ</div>
                    </div>
                </div>
                <div class="lift negative">-9.2%</div>
            </div>
            
            <div class="metric-card">
                <div class="label">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∏—Å–∫–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ)</div>
                <div class="values">
                    <div class="value-box a">
                        <div class="variant">A</div>
                        <div class="value">17,578</div>
                    </div>
                    <div class="value-box b">
                        <div class="variant">B</div>
                        <div class="value">158,958</div>
                    </div>
                </div>
                <div class="lift positive">–í—Å–µ–≥–æ: 176,536</div>
            </div>
        </div>
        
        <!-- –î–Ω–µ–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É -->
        <div class="daily-charts-grid">
            <div class="chart-card">
                <h3>üìä –ó–∞–∫–∞–∑—ã –ø–æ –¥–Ω—è–º</h3>
                <div id="ordersChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üí≥ –û–ø–ª–∞—Ç—ã –ø–æ –¥–Ω—è–º</h3>
                <div id="paymentsChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üß≠ –ö–æ–Ω–≤–µ—Ä—Å–∏—è: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Üí –æ–ø–ª–∞—Ç—ã (CVR, %)</h3>
                <div id="cvrUsersChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üí≥ –ö–æ–Ω–≤–µ—Ä—Å–∏—è: –∑–∞–∫–∞–∑ ‚Üí –æ–ø–ª–∞—Ç–∞ (Pay-through, %)</h3>
                <div id="payRateChart" class="chart"></div>
            </div>
        </div>
        
        <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ -->
        <div class="charts-grid">
            <div class="chart-card">
                <h3>üìà CVR (–ø–æ–∏—Å–∫ ‚Üí –æ–ø–ª–∞—Ç–∞), bps</h3>
                <div id="metricsCvrChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üí∞ RPV (‚ÇΩ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∏—Å–∫–∞)</h3>
                <div id="metricsRpvChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üßæ AOV (—Ç—ã—Å. ‚ÇΩ)</h3>
                <div id="metricsAovChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üìâ –í–æ—Ä–æ–Ω–∫–∞ 1: –ü–æ–∏—Å–∫ ‚Üí –ó–∞–∫–∞–∑—ã (% –æ—Ç –ø–æ–∏—Å–∫–∞)</h3>
                <div id="funnelChart1" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3>üìâ –í–æ—Ä–æ–Ω–∫–∞ 2: –ó–∞–∫–∞–∑—ã ‚Üí –û–ø–ª–∞—Ç—ã (% –æ—Ç –∑–∞–∫–∞–∑–æ–≤)</h3>
                <div id="funnelChart2" class="chart"></div>
            </div>
        </div>
        
        <div class="chart-card">
            <h3>üìã –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <table class="funnel-table">
                <tr>
                    <th>–ú–µ—Ç—Ä–∏–∫–∞</th>
                    <th>–ì—Ä—É–ø–ø–∞ A</th>
                    <th>–ì—Ä—É–ø–ø–∞ B</th>
                    <th>Œî –∞–±—Å.</th>
                    <th>Œî –æ—Ç–Ω.</th>
                </tr>
                <tr>
                    <td>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ–∏—Å–∫)</td>
                    <td>17,578</td>
                    <td>158,958</td>
                    <td>+141,380</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td>–ó–∞–∫–∞–∑–æ–≤</td>
                    <td>211</td>
                    <td>1,920</td>
                    <td>+1,709</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td>–û–ø–ª–∞—Ç</td>
                    <td>57</td>
                    <td>383</td>
                    <td>+326</td>
                    <td>‚Äî</td>
                </tr>
                <tr>
                    <td>–í—ã—Ä—É—á–∫–∞</td>
                    <td>10,487,285‚ÇΩ</td>
                    <td>63,975,434‚ÇΩ</td>
                    <td>+53,488,149‚ÇΩ</td>
                    <td>‚Äî</td>
                </tr>
                <tr style="font-weight: bold; background: rgba(255,255,255,0.05);">
                    <td>CVR</td>
                    <td>0.32%</td>
                    <td>0.24%</td>
                    <td style="color: #e74c3c">-0.08%</td>
                    <td style="color: #e74c3c">-25.7%</td>
                </tr>
                <tr style="font-weight: bold; background: rgba(255,255,255,0.05);">
                    <td>RPV</td>
                    <td>597‚ÇΩ</td>
                    <td>402‚ÇΩ</td>
                    <td style="color: #e74c3c">-194‚ÇΩ</td>
                    <td style="color: #e74c3c">-32.5%</td>
                </tr>
                <tr style="font-weight: bold; background: rgba(255,255,255,0.05);">
                    <td>AOV</td>
                    <td>183,987‚ÇΩ</td>
                    <td>167,038‚ÇΩ</td>
                    <td style="color: #e74c3c">-16,950‚ÇΩ</td>
                    <td style="color: #e74c3c">-9.2%</td>
                </tr>
            </table>
        </div>
        
        <div class="footer">
            –û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: 2026-01-22 10:32:46 | WorkOS AB Test Dashboard
        </div>
    </div>
    
    <script>
        // Store data with tour operators for filtering
        const rawData = {
            df: [{"variant": "a", "tour_operator": "Anex", "total_orders": 16, "unique_users": 12, "paid_orders": 5, "total_gmv": 4232642.0, "paid_revenue": 1861870.0, "avg_paid_order_value": 372374.0}, {"variant": "a", "tour_operator": "Biblio Globus", "total_orders": 34, "unique_users": 27, "paid_orders": 10, "total_gmv": 5883153.0, "paid_revenue": 1813480.0, "avg_paid_order_value": 181348.0}, {"variant": "a", "tour_operator": "Coral Travel", "total_orders": 2, "unique_users": 2, "paid_orders": 0, "total_gmv": 397174.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "a", "tour_operator": "FUN&SUN", "total_orders": 23, "unique_users": 18, "paid_orders": 10, "total_gmv": 4474190.0, "paid_revenue": 1754819.0, "avg_paid_order_value": 175481.9}, {"variant": "a", "tour_operator": "ICS Travel Group", "total_orders": 16, "unique_users": 10, "paid_orders": 2, "total_gmv": 2991368.0, "paid_revenue": 258003.0, "avg_paid_order_value": 129001.5}, {"variant": "a", "tour_operator": "Intourist", "total_orders": 5, "unique_users": 5, "paid_orders": 2, "total_gmv": 816377.0, "paid_revenue": 350021.0, "avg_paid_order_value": 175010.5}, {"variant": "a", "tour_operator": "Let‚Äôs Fly", "total_orders": 9, "unique_users": 6, "paid_orders": 1, "total_gmv": 1523429.0, "paid_revenue": 111299.0, "avg_paid_order_value": 111299.0}, {"variant": "a", "tour_operator": "One Touch Travel", "total_orders": 3, "unique_users": 2, "paid_orders": 0, "total_gmv": 821184.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "a", "tour_operator": "PAKS", "total_orders": 3, "unique_users": 3, "paid_orders": 0, "total_gmv": 806841.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "a", "tour_operator": "Pegas Touristik", "total_orders": 17, "unique_users": 13, "paid_orders": 3, "total_gmv": 2941247.0, "paid_revenue": 587389.0, "avg_paid_order_value": 195796.33333333334}, {"variant": "a", "tour_operator": "RussianExpress", "total_orders": 1, "unique_users": 1, "paid_orders": 0, "total_gmv": 121518.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "a", "tour_operator": "Space Travel", "total_orders": 8, "unique_users": 8, "paid_orders": 2, "total_gmv": 1538376.0, "paid_revenue": 218537.0, "avg_paid_order_value": 109268.5}, {"variant": "a", "tour_operator": "Sunmar", "total_orders": 18, "unique_users": 14, "paid_orders": 4, "total_gmv": 3468202.0, "paid_revenue": 735770.0, "avg_paid_order_value": 183942.5}, {"variant": "a", "tour_operator": "Tez Tour", "total_orders": 8, "unique_users": 5, "paid_orders": 0, "total_gmv": 2331274.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "a", "tour_operator": "Travelata", "total_orders": 48, "unique_users": 31, "paid_orders": 18, "total_gmv": 9864618.0, "paid_revenue": 2796097.0, "avg_paid_order_value": 155338.72222222222}, {"variant": "b", "tour_operator": "AleanTour", "total_orders": 6, "unique_users": 6, "paid_orders": 0, "total_gmv": 550840.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "b", "tour_operator": "Anex", "total_orders": 110, "unique_users": 87, "paid_orders": 21, "total_gmv": 26474225.0, "paid_revenue": 4298025.0, "avg_paid_order_value": 204667.85714285713}, {"variant": "b", "tour_operator": "Biblio Globus", "total_orders": 363, "unique_users": 258, "paid_orders": 85, "total_gmv": 65654545.0, "paid_revenue": 13296514.0, "avg_paid_order_value": 156429.57647058825}, {"variant": "b", "tour_operator": "China Travel", "total_orders": 2, "unique_users": 1, "paid_orders": 0, "total_gmv": 1099072.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "b", "tour_operator": "Coral Travel", "total_orders": 25, "unique_users": 21, "paid_orders": 6, "total_gmv": 4752379.0, "paid_revenue": 1087148.0, "avg_paid_order_value": 181191.33333333334}, {"variant": "b", "tour_operator": "FUN&SUN", "total_orders": 144, "unique_users": 115, "paid_orders": 34, "total_gmv": 29579530.0, "paid_revenue": 5791220.0, "avg_paid_order_value": 170330.0}, {"variant": "b", "tour_operator": "ICS Travel Group", "total_orders": 138, "unique_users": 88, "paid_orders": 20, "total_gmv": 23313890.0, "paid_revenue": 3320504.0, "avg_paid_order_value": 166025.2}, {"variant": "b", "tour_operator": "IZI Tour", "total_orders": 1, "unique_users": 1, "paid_orders": 0, "total_gmv": 224249.0, "paid_revenue": NaN, "avg_paid_order_value": NaN}, {"variant": "b", "tour_operator": "Intourist", "total_orders": 84, "unique_users": 68, "paid_orders": 16, "total_gmv": 17122308.0, "paid_revenue": 2526775.0, "avg_paid_order_value": 157923.4375}, {"variant": "b", "tour_operator": "Let‚Äôs Fly", "total_orders": 89, "unique_users": 78, "paid_orders": 8, "total_gmv": 19861153.0, "paid_revenue": 1672610.0, "avg_paid_order_value": 209076.25}, {"variant": "b", "tour_operator": "One Touch Travel", "total_orders": 39, "unique_users": 26, "paid_orders": 2, "total_gmv": 9652148.0, "paid_revenue": 805791.0, "avg_paid_order_value": 402895.5}, {"variant": "b", "tour_operator": "PAKS", "total_orders": 61, "unique_users": 49, "paid_orders": 6, "total_gmv": 18736275.0, "paid_revenue": 1797241.0, "avg_paid_order_value": 299540.1666666667}, {"variant": "b", "tour_operator": "Pegas Touristik", "total_orders": 188, "unique_users": 130, "paid_orders": 34, "total_gmv": 35611754.0, "paid_revenue": 6736333.0, "avg_paid_order_value": 198127.4411764706}, {"variant": "b", "tour_operator": "RussianExpress", "total_orders": 39, "unique_users": 27, "paid_orders": 9, "total_gmv": 10241298.0, "paid_revenue": 1925518.0, "avg_paid_order_value": 213946.44444444444}, {"variant": "b", "tour_operator": "Space Travel", "total_orders": 129, "unique_users": 93, "paid_orders": 11, "total_gmv": 25983953.0, "paid_revenue": 2070973.0, "avg_paid_order_value": 188270.27272727274}, {"variant": "b", "tour_operator": "Sunmar", "total_orders": 80, "unique_users": 60, "paid_orders": 22, "total_gmv": 15063809.0, "paid_revenue": 3641251.0, "avg_paid_order_value": 165511.4090909091}, {"variant": "b", "tour_operator": "Tez Tour", "total_orders": 45, "unique_users": 30, "paid_orders": 2, "total_gmv": 11389886.0, "paid_revenue": 497653.0, "avg_paid_order_value": 248826.5}, {"variant": "b", "tour_operator": "Travelata", "total_orders": 377, "unique_users": 279, "paid_orders": 107, "total_gmv": 73386205.0, "paid_revenue": 14507878.0, "avg_paid_order_value": 135587.6448598131}],
            daily_df: [{"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 7, "unique_users": 5, "paid_orders": 3, "paid_revenue": 1304065.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 3, "unique_users": 3, "paid_orders": 1, "paid_revenue": 286245.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 12, "unique_users": 8, "paid_orders": 5, "paid_revenue": 934461.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Let‚Äôs Fly", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 6, "unique_users": 3, "paid_orders": 2, "paid_revenue": 382176.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 5, "unique_users": 5, "paid_orders": 3, "paid_revenue": 418788.0}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 2, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 13, "unique_users": 8, "paid_orders": 4, "paid_revenue": 508973.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 20, "unique_users": 19, "paid_orders": 6, "paid_revenue": 1260698.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 98, "unique_users": 77, "paid_orders": 26, "paid_revenue": 4005562.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 5, "unique_users": 4, "paid_orders": 2, "paid_revenue": 336835.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 45, "unique_users": 34, "paid_orders": 13, "paid_revenue": 2722743.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 34, "unique_users": 19, "paid_orders": 4, "paid_revenue": 747069.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "IZI Tour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 13, "unique_users": 13, "paid_orders": 4, "paid_revenue": 753581.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 18, "unique_users": 16, "paid_orders": 1, "paid_revenue": 195214.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 7, "unique_users": 6, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 16, "unique_users": 12, "paid_orders": 2, "paid_revenue": 533615.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 43, "unique_users": 35, "paid_orders": 10, "paid_revenue": 2365538.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 18, "unique_users": 11, "paid_orders": 5, "paid_revenue": 1142410.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 25, "unique_users": 18, "paid_orders": 1, "paid_revenue": 291253.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 13, "unique_users": 12, "paid_orders": 4, "paid_revenue": 864695.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 4, "unique_users": 4, "paid_orders": 2, "paid_revenue": 497653.0}, {"date": "2026-01-20 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 89, "unique_users": 67, "paid_orders": 30, "paid_revenue": 4404393.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 6, "unique_users": 5, "paid_orders": 1, "paid_revenue": 357420.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 25, "unique_users": 20, "paid_orders": 8, "paid_revenue": 1502223.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Coral Travel", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 7, "unique_users": 7, "paid_orders": 3, "paid_revenue": 466449.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 13, "unique_users": 9, "paid_orders": 2, "paid_revenue": 258003.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 2, "unique_users": 2, "paid_orders": 1, "paid_revenue": 287907.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Let‚Äôs Fly", "orders": 8, "unique_users": 5, "paid_orders": 1, "paid_revenue": 111299.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "One Touch Travel", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 10, "unique_users": 9, "paid_orders": 1, "paid_revenue": 205213.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "RussianExpress", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 5, "unique_users": 5, "paid_orders": 2, "paid_revenue": 218537.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 9, "unique_users": 8, "paid_orders": 1, "paid_revenue": 316982.0}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 4, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 31, "unique_users": 20, "paid_orders": 12, "paid_revenue": 2094298.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 4, "unique_users": 4, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 77, "unique_users": 61, "paid_orders": 13, "paid_revenue": 2486415.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 208, "unique_users": 155, "paid_orders": 48, "paid_revenue": 7629724.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "China Travel", "orders": 2, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 15, "unique_users": 13, "paid_orders": 4, "paid_revenue": 750313.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 61, "unique_users": 52, "paid_orders": 14, "paid_revenue": 1814741.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 85, "unique_users": 57, "paid_orders": 16, "paid_revenue": 2573435.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 60, "unique_users": 46, "paid_orders": 10, "paid_revenue": 1368346.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 60, "unique_users": 52, "paid_orders": 6, "paid_revenue": 1291199.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 30, "unique_users": 20, "paid_orders": 2, "paid_revenue": 805791.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 33, "unique_users": 26, "paid_orders": 4, "paid_revenue": 1263626.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 113, "unique_users": 82, "paid_orders": 21, "paid_revenue": 4039118.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 18, "unique_users": 13, "paid_orders": 4, "paid_revenue": 783108.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 84, "unique_users": 63, "paid_orders": 9, "paid_revenue": 1691197.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 44, "unique_users": 38, "paid_orders": 13, "paid_revenue": 1757170.0}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 27, "unique_users": 19, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-21 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 205, "unique_users": 163, "paid_orders": 60, "paid_revenue": 7434490.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Anex", "orders": 3, "unique_users": 3, "paid_orders": 1, "paid_revenue": 200385.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Biblio Globus", "orders": 6, "unique_users": 5, "paid_orders": 1, "paid_revenue": 25012.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "FUN&SUN", "orders": 4, "unique_users": 4, "paid_orders": 2, "paid_revenue": 353909.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "ICS Travel Group", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Intourist", "orders": 1, "unique_users": 1, "paid_orders": 1, "paid_revenue": 62114.0}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "One Touch Travel", "orders": 2, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "PAKS", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Pegas Touristik", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Space Travel", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Sunmar", "orders": 4, "unique_users": 3, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Tez Tour", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "a", "tour_operator": "Travelata", "orders": 4, "unique_users": 4, "paid_orders": 2, "paid_revenue": 192826.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "AleanTour", "orders": 1, "unique_users": 1, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Anex", "orders": 13, "unique_users": 11, "paid_orders": 2, "paid_revenue": 550912.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Biblio Globus", "orders": 57, "unique_users": 41, "paid_orders": 11, "paid_revenue": 1661228.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Coral Travel", "orders": 5, "unique_users": 5, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "FUN&SUN", "orders": 38, "unique_users": 30, "paid_orders": 7, "paid_revenue": 1253736.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "ICS Travel Group", "orders": 19, "unique_users": 17, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Intourist", "orders": 11, "unique_users": 10, "paid_orders": 2, "paid_revenue": 404848.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Let‚Äôs Fly", "orders": 11, "unique_users": 11, "paid_orders": 1, "paid_revenue": 186197.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "One Touch Travel", "orders": 2, "unique_users": 2, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "PAKS", "orders": 12, "unique_users": 11, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Pegas Touristik", "orders": 32, "unique_users": 23, "paid_orders": 3, "paid_revenue": 331677.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "RussianExpress", "orders": 3, "unique_users": 3, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Space Travel", "orders": 20, "unique_users": 14, "paid_orders": 1, "paid_revenue": 88523.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Sunmar", "orders": 23, "unique_users": 13, "paid_orders": 5, "paid_revenue": 1019386.0}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Tez Tour", "orders": 14, "unique_users": 10, "paid_orders": 0, "paid_revenue": NaN}, {"date": "2026-01-22 00:00:00", "variant": "b", "tour_operator": "Travelata", "orders": 83, "unique_users": 65, "paid_orders": 17, "paid_revenue": 2668995.0}],
            dates: ["2026-01-20", "2026-01-21", "2026-01-22"]
        };
        
        // Filter function
        function filterByTourOperators(selectedOperators) {
            if (selectedOperators.length === 0) {
                return {
                    aggregated: {},
                    dailyAggregated: [],
                    dates: rawData.dates
                };
            }
            
            // Filter main data
            const filteredDf = rawData.df.filter(row => 
                selectedOperators.includes(row.tour_operator)
            );
            
            // Filter daily data
            const filteredDailyDf = rawData.daily_df.filter(row => 
                selectedOperators.includes(row.tour_operator)
            );
            
            // Aggregate by variant
            const aggregated = {};
            filteredDf.forEach(row => {
                if (!aggregated[row.variant]) {
                    aggregated[row.variant] = {
                        total_orders: 0,
                        unique_users: 0,
                        paid_orders: 0,
                        total_gmv: 0,
                        paid_revenue: 0
                    };
                }
                aggregated[row.variant].total_orders += row.total_orders;
                aggregated[row.variant].unique_users += row.unique_users;
                aggregated[row.variant].paid_orders += row.paid_orders;
                aggregated[row.variant].total_gmv += row.total_gmv;
                aggregated[row.variant].paid_revenue += row.paid_revenue;
            });
            
            // Calculate AOV
            Object.keys(aggregated).forEach(variant => {
                aggregated[variant].avg_paid_order_value = 
                    aggregated[variant].paid_orders > 0 
                        ? aggregated[variant].paid_revenue / aggregated[variant].paid_orders 
                        : 0;
            });
            
            // Aggregate daily data by date and variant
            const dailyAggregated = {};
            filteredDailyDf.forEach(row => {
                const key = `${row.date}_${row.variant}`;
                if (!dailyAggregated[key]) {
                    dailyAggregated[key] = {
                        date: row.date,
                        variant: row.variant,
                        orders: 0,
                        unique_users: 0,
                        paid_orders: 0,
                        paid_revenue: 0
                    };
                }
                dailyAggregated[key].orders += row.orders;
                dailyAggregated[key].unique_users += row.unique_users;
                dailyAggregated[key].paid_orders += row.paid_orders;
                dailyAggregated[key].paid_revenue += row.paid_revenue;
            });
            
            return {
                aggregated,
                dailyAggregated: Object.values(dailyAggregated),
                dates: rawData.dates
            };
        }
        
        // Update charts based on selected tour operators
        function updateCharts() {
            const checkboxes = document.querySelectorAll('.tour-operator-filter:checked');
            const selectedOperators = Array.from(checkboxes).map(cb => cb.value);
            
            if (selectedOperators.length === 0) {
                return;
            }
            
            const filtered = filterByTourOperators(selectedOperators);
            
            if (Object.keys(filtered.aggregated).length === 0) {
                return;
            }
            
            const aData = filtered.aggregated['a'] || {};
            const bData = filtered.aggregated['b'] || {};
            
            // Calculate metrics
            const users_search_a = 17578;
            const users_search_b = 158958;
            const paid_a = aData.paid_orders || 0;
            const paid_b = bData.paid_orders || 0;
            const orders_a = aData.total_orders || 0;
            const orders_b = bData.total_orders || 0;
            const revenue_a = aData.paid_revenue || 0;
            const revenue_b = bData.paid_revenue || 0;
            
            const cvr_a = users_search_a > 0 ? (paid_a / users_search_a * 100) : 0;
            const cvr_b = users_search_b > 0 ? (paid_b / users_search_b * 100) : 0;
            const rpv_a = users_search_a > 0 ? (revenue_a / users_search_a) : 0;
            const rpv_b = users_search_b > 0 ? (revenue_b / users_search_b) : 0;
            const aov_a = paid_a > 0 ? (revenue_a / paid_a) : 0;
            const aov_b = paid_b > 0 ? (revenue_b / paid_b) : 0;
            
            // Prepare daily data
            const dailyA = filtered.dailyAggregated.filter(r => r.variant === 'a').sort((a, b) => a.date.localeCompare(b.date));
            const dailyB = filtered.dailyAggregated.filter(r => r.variant === 'b').sort((a, b) => a.date.localeCompare(b.date));
            
            const dates = filtered.dates;
            const orders_a_daily = dates.map(d => {
                const dayData = dailyA.find(r => r.date === d);
                return dayData ? dayData.orders : 0;
            });
            const orders_b_daily = dates.map(d => {
                const dayData = dailyB.find(r => r.date === d);
                return dayData ? dayData.orders : 0;
            });
            const paid_a_daily = dates.map(d => {
                const dayData = dailyA.find(r => r.date === d);
                return dayData ? dayData.paid_orders : 0;
            });
            const paid_b_daily = dates.map(d => {
                const dayData = dailyB.find(r => r.date === d);
                return dayData ? dayData.paid_orders : 0;
            });
            
            const search_users_a_daily = [4381, 11285, 4575];
            const search_users_b_daily = [39963, 102501, 40663];
            
            const cvr_users_a_daily = paid_a_daily.map((p, i) => search_users_a_daily[i] > 0 ? (p / search_users_a_daily[i] * 100) : 0);
            const cvr_users_b_daily = paid_b_daily.map((p, i) => search_users_b_daily[i] > 0 ? (p / search_users_b_daily[i] * 100) : 0);
            const payrate_a_daily = orders_a_daily.map((o, i) => o > 0 ? (paid_a_daily[i] / o * 100) : 0);
            const payrate_b_daily = orders_b_daily.map((o, i) => o > 0 ? (paid_b_daily[i] / o * 100) : 0);
            
            // Calculate additional metrics
            const orders_pct_a = users_search_a > 0 ? (orders_a / users_search_a * 100) : 0;
            const orders_pct_b = users_search_b > 0 ? (orders_b / users_search_b * 100) : 0;
            const pay_through_pct_a = orders_a > 0 ? (paid_a / orders_a * 100) : 0;
            const pay_through_pct_b = orders_b > 0 ? (paid_b / orders_b * 100) : 0;
            const cvr_lift = cvr_a > 0 ? ((cvr_b - cvr_a) / cvr_a * 100) : 0;
            const rpv_lift = rpv_a > 0 ? ((rpv_b - rpv_a) / rpv_a * 100) : 0;
            const aov_lift = aov_a > 0 ? ((aov_b - aov_a) / aov_a * 100) : 0;
            
            // Update HTML elements (metrics cards, table, split bar)
            updateMetricsDisplay({
                cvr_a, cvr_b, cvr_lift,
                rpv_a, rpv_b, rpv_lift,
                aov_a, aov_b, aov_lift,
                users_search_a, users_search_b,
                orders_a, orders_b,
                paid_a, paid_b,
                revenue_a, revenue_b
            });
            
            // Redraw all charts completely
            Plotly.redraw('ordersChart');
            Plotly.react('ordersChart', [
                {
                    x: dates,
                    y: orders_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: dates,
                    y: orders_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–ó–∞–∫–∞–∑—ã' }
            }, { responsive: true });
            
            Plotly.react('paymentsChart', [
                {
                    x: dates,
                    y: paid_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#3498db', width: 3 },
                    marker: { size: 8 }
                },
                {
                    x: dates,
                    y: paid_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#9b59b6', width: 3 },
                    marker: { size: 8 }
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–û–ø–ª–∞—Ç—ã' }
            }, { responsive: true });
            
            Plotly.react('cvrUsersChart', [
                {
                    x: dates,
                    y: cvr_users_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#3498db', width: 3 },
                    marker: { size: 8 },
                    hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
                },
                {
                    x: dates,
                    y: cvr_users_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#9b59b6', width: 3 },
                    marker: { size: 8 },
                    hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 60 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR', ticksuffix: '%' }
            }, { responsive: true });
            
            Plotly.react('payRateChart', [
                {
                    x: dates,
                    y: payrate_a_daily,
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#3498db', width: 3 },
                    marker: { size: 8 },
                    text: payrate_a_daily,
                    hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
                },
                {
                    x: dates,
                    y: payrate_b_daily,
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { color: '#9b59b6', width: 3 },
                    marker: { size: 8 },
                    hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 60 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'Pay-through', ticksuffix: '%' }
            }, { responsive: true });
            
            Plotly.react('metricsCvrChart', [
                {
                    x: ['CVR (bps)'],
                    y: [cvr_a * 100],
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: ['CVR (bps)'],
                    y: [cvr_b * 100],
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR (bps)' }
            }, { responsive: true });
            
            Plotly.react('metricsRpvChart', [
                {
                    x: ['RPV (‚ÇΩ)'],
                    y: [rpv_a],
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: ['RPV (‚ÇΩ)'],
                    y: [rpv_b],
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'RPV, ‚ÇΩ' }
            }, { responsive: true });
            
            Plotly.react('metricsAovChart', [
                {
                    x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                    y: [aov_a / 1000],
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    type: 'bar',
                    marker: { color: '#3498db' }
                },
                {
                    x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                    y: [aov_b / 1000],
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    type: 'bar',
                    marker: { color: '#9b59b6' }
                }
            ], {
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 40, l: 50 },
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
                yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'AOV, —Ç—ã—Å. ‚ÇΩ' }
            }, { responsive: true });
            
            Plotly.react('funnelChart1', [
                {
                    type: 'funnel',
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                    x: [100, orders_pct_a],
                    text: [String(users_search_a).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(orders_a).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#3498db' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
                },
                {
                    type: 'funnel',
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                    x: [100, orders_pct_b],
                    text: [String(users_search_b).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(orders_b).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#9b59b6' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 20, l: 100 },
                legend: { orientation: 'h', y: -0.1 },
                funnelmode: 'group'
            }, { responsive: true });
            
            Plotly.react('funnelChart2', [
                {
                    type: 'funnel',
                    name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                    y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                    x: [100, pay_through_pct_a],
                    text: [String(orders_a).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(paid_a).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#3498db' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
                },
                {
                    type: 'funnel',
                    name: 'B (—Å–∫–∏–¥–∫–∞)',
                    y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                    x: [100, pay_through_pct_b],
                    text: [String(orders_b).replace(/\B(?=(\d{3})+(?!\d))/g, ','), String(paid_b).replace(/\B(?=(\d{3})+(?!\d))/g, ',')],
                    textposition: 'inside',
                    marker: { color: '#9b59b6' },
                    textfont: { color: '#fff' },
                    hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
                }
            ], {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#fff' },
                margin: { t: 20, r: 20, b: 20, l: 100 },
                legend: { orientation: 'h', y: -0.1 },
                funnelmode: 'group'
            }, { responsive: true });
        }
        
        // Update HTML metrics display
        function updateMetricsDisplay(metrics) {
            // Update metric cards
            const cvrCard = document.querySelector('.metric-card:nth-child(1)');
            if (cvrCard) {
                cvrCard.querySelector('.value-box.a .value').textContent = metrics.cvr_a.toFixed(2) + '%';
                cvrCard.querySelector('.value-box.b .value').textContent = metrics.cvr_b.toFixed(2) + '%';
                const liftEl = cvrCard.querySelector('.lift');
                liftEl.textContent = (metrics.cvr_lift >= 0 ? '+' : '') + metrics.cvr_lift.toFixed(1) + '%';
                liftEl.className = 'lift ' + (metrics.cvr_lift < 0 ? 'negative' : 'positive');
            }
            
            const rpvCard = document.querySelector('.metric-card:nth-child(2)');
            if (rpvCard) {
                rpvCard.querySelector('.value-box.a .value').textContent = Math.round(metrics.rpv_a) + '‚ÇΩ';
                rpvCard.querySelector('.value-box.b .value').textContent = Math.round(metrics.rpv_b) + '‚ÇΩ';
                const liftEl = rpvCard.querySelector('.lift');
                liftEl.textContent = (metrics.rpv_lift >= 0 ? '+' : '') + metrics.rpv_lift.toFixed(1) + '%';
                liftEl.className = 'lift ' + (metrics.rpv_lift < 0 ? 'negative' : 'positive');
            }
            
            const aovCard = document.querySelector('.metric-card:nth-child(3)');
            if (aovCard) {
                aovCard.querySelector('.value-box.a .value').textContent = Math.round(metrics.aov_a).toLocaleString('ru-RU') + '‚ÇΩ';
                aovCard.querySelector('.value-box.b .value').textContent = Math.round(metrics.aov_b).toLocaleString('ru-RU') + '‚ÇΩ';
                const liftEl = aovCard.querySelector('.lift');
                liftEl.textContent = (metrics.aov_lift >= 0 ? '+' : '') + metrics.aov_lift.toFixed(1) + '%';
                liftEl.className = 'lift ' + (metrics.aov_lift < 0 ? 'negative' : 'positive');
            }
            
            // Update target card
            const targetCard = document.querySelector('.target-card');
            if (targetCard) {
                const statusEl = targetCard.querySelector('.status');
                const detailsEl = targetCard.querySelector('.details');
                if (metrics.rpv_lift >= 5) {
                    statusEl.textContent = '‚úÖ –î–û–°–¢–ò–ì–ù–£–¢';
                    statusEl.style.color = '#27ae60';
                } else {
                    statusEl.textContent = '‚ùå –ù–ï –î–û–°–¢–ò–ì–ù–£–¢';
                    statusEl.style.color = '#e74c3c';
                }
                detailsEl.textContent = '–§–∞–∫—Ç: ' + (metrics.rpv_lift >= 0 ? '+' : '') + metrics.rpv_lift.toFixed(1) + '%';
            }
            
            // Update split bar
            const totalUsers = metrics.users_search_a + metrics.users_search_b;
            if (totalUsers > 0) {
                const splitA = document.querySelector('.split-bar .a');
                const splitB = document.querySelector('.split-bar .b');
                if (splitA && splitB) {
                    const pctA = (metrics.users_search_a / totalUsers * 100).toFixed(1);
                    const pctB = (metrics.users_search_b / totalUsers * 100).toFixed(1);
                    splitA.style.width = pctA + '%';
                    splitA.textContent = pctA + '%';
                    splitB.style.width = pctB + '%';
                    splitB.textContent = pctB + '%';
                }
            }
            
            // Update table
            const tableRows = document.querySelectorAll('.funnel-table tr');
            if (tableRows.length >= 6) {
                // Users row
                tableRows[1].cells[1].textContent = metrics.users_search_a.toLocaleString('ru-RU');
                tableRows[1].cells[2].textContent = metrics.users_search_b.toLocaleString('ru-RU');
                tableRows[1].cells[3].textContent = '+' + (metrics.users_search_b - metrics.users_search_a).toLocaleString('ru-RU');
                
                // Orders row
                tableRows[2].cells[1].textContent = metrics.orders_a.toLocaleString('ru-RU');
                tableRows[2].cells[2].textContent = metrics.orders_b.toLocaleString('ru-RU');
                tableRows[2].cells[3].textContent = '+' + (metrics.orders_b - metrics.orders_a).toLocaleString('ru-RU');
                
                // Paid row
                tableRows[3].cells[1].textContent = metrics.paid_a.toLocaleString('ru-RU');
                tableRows[3].cells[2].textContent = metrics.paid_b.toLocaleString('ru-RU');
                tableRows[3].cells[3].textContent = '+' + (metrics.paid_b - metrics.paid_a).toLocaleString('ru-RU');
                
                // Revenue row
                tableRows[4].cells[1].textContent = Math.round(metrics.revenue_a).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[4].cells[2].textContent = Math.round(metrics.revenue_b).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[4].cells[3].textContent = '+' + Math.round(metrics.revenue_b - metrics.revenue_a).toLocaleString('ru-RU') + '‚ÇΩ';
                
                // CVR row
                const cvrDiff = metrics.cvr_b - metrics.cvr_a;
                tableRows[5].cells[1].textContent = metrics.cvr_a.toFixed(2) + '%';
                tableRows[5].cells[2].textContent = metrics.cvr_b.toFixed(2) + '%';
                tableRows[5].cells[3].textContent = (cvrDiff >= 0 ? '+' : '') + cvrDiff.toFixed(2) + '%';
                tableRows[5].cells[3].style.color = cvrDiff < 0 ? '#e74c3c' : '#27ae60';
                tableRows[5].cells[4].textContent = (metrics.cvr_lift >= 0 ? '+' : '') + metrics.cvr_lift.toFixed(1) + '%';
                tableRows[5].cells[4].style.color = metrics.cvr_lift < 0 ? '#e74c3c' : '#27ae60';
                
                // RPV row
                const rpvDiff = metrics.rpv_b - metrics.rpv_a;
                tableRows[6].cells[1].textContent = Math.round(metrics.rpv_a).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[6].cells[2].textContent = Math.round(metrics.rpv_b).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[6].cells[3].textContent = (rpvDiff >= 0 ? '+' : '') + Math.round(rpvDiff).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[6].cells[3].style.color = rpvDiff < 0 ? '#e74c3c' : '#27ae60';
                tableRows[6].cells[4].textContent = (metrics.rpv_lift >= 0 ? '+' : '') + metrics.rpv_lift.toFixed(1) + '%';
                tableRows[6].cells[4].style.color = metrics.rpv_lift < 0 ? '#e74c3c' : '#27ae60';
                
                // AOV row
                const aovDiff = metrics.aov_b - metrics.aov_a;
                tableRows[7].cells[1].textContent = Math.round(metrics.aov_a).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[7].cells[2].textContent = Math.round(metrics.aov_b).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[7].cells[3].textContent = (aovDiff >= 0 ? '+' : '') + Math.round(aovDiff).toLocaleString('ru-RU') + '‚ÇΩ';
                tableRows[7].cells[3].style.color = aovDiff < 0 ? '#e74c3c' : '#27ae60';
                tableRows[7].cells[4].textContent = (metrics.aov_lift >= 0 ? '+' : '') + metrics.aov_lift.toFixed(1) + '%';
                tableRows[7].cells[4].style.color = metrics.aov_lift < 0 ? '#e74c3c' : '#27ae60';
            }
        }
        
        // Setup filter event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const allCheckbox = document.getElementById('filter-all');
            const operatorCheckboxes = document.querySelectorAll('.tour-operator-filter');
            
            allCheckbox.addEventListener('change', function() {
                operatorCheckboxes.forEach(cb => {
                    cb.checked = this.checked;
                });
                updateCharts();
            });
            
            operatorCheckboxes.forEach(cb => {
                cb.addEventListener('change', function() {
                    const allChecked = Array.from(operatorCheckboxes).every(c => c.checked);
                    allCheckbox.checked = allChecked;
                    updateCharts();
                });
            });
        });
        
        // Orders chart
        Plotly.newPlot('ordersChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [54, 124, 33],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [450, 1126, 344],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–ó–∞–∫–∞–∑—ã' }
        }, { responsive: true });
        
        // Payments chart
        Plotly.newPlot('paymentsChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [18, 32, 7],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#3498db', width: 3 },
                marker: { size: 8 }
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [110, 224, 49],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9b59b6', width: 3 },
                marker: { size: 8 }
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: '–û–ø–ª–∞—Ç—ã' }
        }, { responsive: true });
        
        // Metrics comparison chart - CVR in basis points
        Plotly.newPlot('metricsCvrChart', [
            {
                x: ['CVR (bps)'],
                y: [32.42689725793606],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['CVR (bps)'],
                y: [24.09441487688572],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR (bps)' }
        }, { responsive: true });
        
        // Metrics comparison chart - RPV in RUB
        Plotly.newPlot('metricsRpvChart', [
            {
                x: ['RPV (‚ÇΩ)'],
                y: [596.6142337012175],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['RPV (‚ÇΩ)'],
                y: [402.46753230413066],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'RPV, ‚ÇΩ' }
        }, { responsive: true });
        
        // Metrics comparison chart - AOV in thousands RUB
        Plotly.newPlot('metricsAovChart', [
            {
                x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                y: [183.98745614035087],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'bar',
                marker: { color: '#3498db' }
            },
            {
                x: ['AOV (—Ç—ã—Å.‚ÇΩ)'],
                y: [167.0376866840731],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'bar',
                marker: { color: '#9b59b6' }
            }
        ], {
            barmode: 'group',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 50 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'AOV, —Ç—ã—Å. ‚ÇΩ' }
        }, { responsive: true });
        
        // Funnel chart 1: –ü–æ–∏—Å–∫ ‚Üí –ó–∞–∫–∞–∑—ã (–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, % –æ—Ç –ø–æ–∏—Å–∫–∞)
        Plotly.newPlot('funnelChart1', [
            {
                type: 'funnel',
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                x: [100, 1.2003640914779838],
                text: ['17,578', '211'],
                textposition: 'inside',
                marker: { color: '#3498db' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
            },
            {
                type: 'funnel',
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                y: ['–ü–æ–∏—Å–∫', '–ó–∞–∫–∞–∑—ã'],
                x: [100, 1.2078662288151587],
                text: ['158,958', '1,920'],
                textposition: 'inside',
                marker: { color: '#9b59b6' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %{text}<br>–î–æ–ª—è –æ—Ç –ø–æ–∏—Å–∫–∞: %{x:.2f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 20, l: 100 },
            legend: { orientation: 'h', y: -0.1 },
            funnelmode: 'group'
        }, { responsive: true });
        
        // Funnel chart 2: –ó–∞–∫–∞–∑—ã ‚Üí –û–ø–ª–∞—Ç—ã (–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, % –æ—Ç –∑–∞–∫–∞–∑–æ–≤)
        Plotly.newPlot('funnelChart2', [
            {
                type: 'funnel',
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                x: [100, 27.014218009478675],
                text: ['211', '57'],
                textposition: 'inside',
                marker: { color: '#3498db' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
            },
            {
                type: 'funnel',
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                y: ['–ó–∞–∫–∞–∑—ã', '–û–ø–ª–∞—Ç—ã'],
                x: [100, 19.947916666666668],
                text: ['1,920', '383'],
                textposition: 'inside',
                marker: { color: '#9b59b6' },
                textfont: { color: '#fff' },
                hovertemplate: '%{y}<br>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %{text}<br>–î–æ–ª—è –æ—Ç –∑–∞–∫–∞–∑–æ–≤: %{x:.2f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 20, l: 100 },
            legend: { orientation: 'h', y: -0.1 },
            funnelmode: 'group'
        }, { responsive: true });
        
        // CVR users -> paid
        Plotly.newPlot('cvrUsersChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [0.41, 0.28, 0.15],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#3498db', width: 3 },
                marker: { size: 8 },
                hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [0.28, 0.22, 0.12],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9b59b6', width: 3 },
                marker: { size: 8 },
                hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 60 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'CVR', ticksuffix: '%' }
        }, { responsive: true });
        
        // Pay-through orders -> paid
        Plotly.newPlot('payRateChart', [
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [33.33, 25.81, 21.21],
                name: 'A (–∫–æ–Ω—Ç—Ä–æ–ª—å)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#3498db', width: 3 },
                marker: { size: 8 },
                text: [33.33, 25.81, 21.21],
                hovertemplate: '%{x}<br>A: %{y:.1f}%<extra></extra>'
            },
            {
                x: ['2026-01-20', '2026-01-21', '2026-01-22'],
                y: [24.44, 19.89, 14.24],
                name: 'B (—Å–∫–∏–¥–∫–∞)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9b59b6', width: 3 },
                marker: { size: 8 },
                hovertemplate: '%{x}<br>B: %{y:.1f}%<extra></extra>'
            }
        ], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            margin: { t: 20, r: 20, b: 40, l: 60 },
            legend: { orientation: 'h', y: -0.2 },
            xaxis: { gridcolor: 'rgba(255,255,255,0.1)' },
            yaxis: { gridcolor: 'rgba(255,255,255,0.1)', title: 'Pay-through', ticksuffix: '%' }
        }, { responsive: true });
    </script>

    </div>

    <script src="auth.js"></script>
</body>
</html>
